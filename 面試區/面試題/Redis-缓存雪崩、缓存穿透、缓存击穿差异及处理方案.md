---
界: NoSQL
门: Redis
纲: 
tags: ["#NoSQL","#Redis","#Cache","#BQ"]
aliases:
  - 
date: 2021-09-07

---


## 缓存雪崩
*大量key失效，透过缓存，直接访问db*

-  key的失效期增加随机时长，如200s，100s，错开每个缓存key的缓存时间
-   redis-cluster集群高可用
-   设置本地缓存ehcache、hystrix熔断限流

## 缓存穿透
*不存在的key，穿过缓存查询数据库*

-   对查询结果为空的情况也进行缓存，缓存时间（ttl）设置短一点，或者该key对应的数据insert了 之后清理缓存。
    
    问题：缓存太多空值占用了更多的空间
    
-   使用布隆过滤器。在缓存之前在加一层布隆过滤器，在查询的时候先去布隆过滤器查询 key 是否 存在，如果不存在就直接返回，存在再查缓存和DB。
    
    布隆过滤器的原理是，当一个元素被加入集合时，通过K个Hash函数将这个元素映射成一个数组中的K个点，把它们置为1。检索时，我们只要看看这些点是不是都是1就（大约）知道集合中有没有它了：如果这些点有任何一个0，则被检元素一定不在；如果都是1，则被检元素很可能在。
    

## 缓存击穿
*一个key或一些key 热点key*

-   用分布式锁控制访问的线程
-   不设超时时间，volatile-lru 但会造成写一致问题