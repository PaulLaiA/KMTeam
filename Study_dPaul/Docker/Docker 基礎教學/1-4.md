---
date: 2021-10-22
aliases: ["Docker é•œåƒè©³è§£"]
---

# Metadata

**Title** :: Docker é•œåƒè©³è§£

**Author** :: #dPaulLai

**Classification** :: #Learn #Docker #Basic

**Status** :: #ğŸŒ 

**Type** :: #Note

**Previous** :: [[1-3]]

**ParentNode** :: [[Study_dPaul/Docker/Docker åŸºç¤æ•™å­¸/Docker åŸºç¤æ•™å­¸]]

---


# Docker é•œåƒ

[Docker Hub](https://hub.docker.com/) æ˜¯ä¸€å€‹ç±»ä¼¼ `maven` çš„è¿œç¨‹ä»“åº“ , å­˜å‚¨å…¬å…±çš„ Docker Image

## å®šä¹‰

é•œåƒæ˜¯ç”±å¾ˆå¤šå±‚ç»„æˆ,ç„¶åå°†ä¸åŒçš„å±‚å åŠ ä¹‹å,ä»å¤–éƒ¨å¼€æ¥å°±å¦‚åŒä¸€ä¸ªç‹¬ç«‹çš„å¯¹è±¡

é•œåƒå†…éƒ¨å…¶å®æ˜¯ä¸€ä¸ªç²¾ç®€çš„æ“ä½œç³»ç»Ÿ (OS),åŒæ—¶è¿˜åŒ…å«åº”ç”¨è¿è¡Œæ‰€å¿…è¦çš„æ–‡ä»¶åŠä¾èµ–.

ç„¶åé•œåƒé€šå¸¸è€Œè¨€ä¼šéå¸¸å°

é•œåƒå¯ä»¥ç†è§£ä¸ºæ˜¯ä¸€ç§æ„å»ºæ—¶ ( build-time ) çš„ç»“æ„

æ˜¯ä¸€ç§é™æ­¢çš„çŠ¶æ€

## å¸¸ç”¨å‘½ä»¤

### Pull æ‹‰å–

ä¸‹è½½é•œåƒçš„å‘½ä»¤

é•œåƒä¸€èˆ¬éƒ½æ˜¯ä»è¿œç¨‹é•œåƒä»“åº“æœåŠ¡çš„ä»“åº“è¿›è¡Œä¸‹è½½.é»˜è®¤æƒ…å†µä¸‹ä¼šä» Docker Hub çš„ä»“åº“è¿›è¡Œä¸‹è½½

åœ¨ä¸‹è½½è¿‡ç¨‹ä¸­,å¯ä»¥çœ‹åˆ°ä¸€ä¸ªé•œåƒä¸€èˆ¬æ˜¯ç”±å¤šä¸ªå±‚è¿›è¡Œç»„æˆçš„,
ç±»ä¼¼ `f7e2b70d04ae` çš„ä¸²è¡¨ç¤ºå±‚çš„å”¯ä¸€ ID

    1. åœ¨ä¸åŒé•œåƒä¸­ç”¨åˆ°ç›¸åŒçš„ ID çš„å±‚å°†ä¼šç»§ç»­ä½¿ç”¨æœ¬åœ°çš„å±‚
    2. åœ¨ä½¿ç”¨ Pull å‘½ä»¤çš„æ—¶å€™,docker ä¼šè‡ªåŠ¨åŠ ä¸Šä»“åº“åœ°å€çš„å‰ç¼€
    3. å®Œæ•´çš„ ID åŒ…æ‹¬äº† 256 ä¸ª bit,64 ä¸ªåå…­è¿›åˆ¶å­—ç¬¦ç»„æˆ

**EX:**

```bash
// docker.io æ˜¯æˆ‘é…ç½®çš„é»˜è®¤ä»“åº“åœ°å€
$ docker pull tomcat:9.0.20-jre8
// ç­‰åŒäº
$ docker pull docker.io/tomcat:9.0.20-jre8
```

**å¸¸ç”¨å‚æ•°**

- ` -a, --all-tags=true|false` : æ˜¯å¦è·å–ä»“åº“ä¸­æ‰€æœ‰é•œåƒï¼Œé»˜è®¤ä¸ºå¦ï¼›
- `--disable-content-trust` : è·³è¿‡é•œåƒå†…å®¹çš„æ ¡éªŒï¼Œé»˜è®¤ä¸º true;

### Images æŸ¥çœ‹é•œåƒ

å¯ä»¥é€šè¿‡è¯¥é•œåƒå¯ä»¥åˆ—å‡ºæœ¬åœ°å·²æœ‰çš„é•œåƒ

```bash
$ docker images
$ docker image ls
```

**é€‰é¡¹è¯´æ˜**

| é€‰é¡¹       | è¯´æ˜         |
| ---------- | ------------ |
| Repository | é•œåƒçš„ä»“åº“æº |
| Tag        | é•œåƒæ ‡ç­¾     |
| Images ID  | é•œåƒ ID      |
| Created    | é•œåƒåˆ›å»ºæ—¶é—´ |
| Size       | é•œåƒå¤§å°     |

### Save ä¿å­˜

é€šè¿‡ Save æŒ‡ä»¤å°†é•œåƒä¿å­˜åˆ°æœ¬åœ°

**å¸¸ç”¨å‚æ•°**

- `-o`:è¾“å‡ºåˆ°çš„æ–‡ä»¶

**ä¿å­˜ä¸€ä¸ªé•œåƒ**

```bash
$ docker save tomcat:9.0.20-jre8-alpine -o tomcat9.tar
$ docker save tomcat:9.0.20-jre8-slim > tomcat9.slim.tar
```

**ä¿å­˜å¤šä¸ªé•œåƒ**

    æ¨èå¼€å‘å²—çš„å°ä¼™ä¼´æ¢¦å¯ä»¥ä½¿ç”¨ idea å¼€å‘å·¥å…·ä¸­çš„åˆ—ç¼–è¾‘æ¨¡å¼åˆ¶ä½œ docker save å‘½ä»¤

```bash
$ docker save \
	ubuntu:20.04 \
	alpine:3.12.1 \
	debian:10.6-slim \
	centos:7.8.2003 \
	-o linux.tar

$ docker save \
	tomcat:9.0.20-jre8-alpine \
	tomcat:9.0.20-jre8-slim \
	tomcat:9.0.20-jre8 \
	-o tomcat9.0.20.tar
```

### Load æ±‡å…¥

```bash
$ docker load -i linux.tar
$ docker load < tomcat9.0.20.tar
```

**å¸¸ç”¨å‚æ•°**

- `--input , -i` : æŒ‡å®šå¯¼å…¥çš„æ–‡ä»¶
- `-quiet , -q` : ç²¾ç®€è¾“å‡ºä¿¡æ¯

### Search æœç´¢

ä¸æ¨èä½¿ç”¨ search å‘½ä»¤æŸ¥æ‰¾é•œåƒï¼Œä¸å¤Ÿç›´è§‚ã€‚

```bash
$ docker search tomcat
```

**å¸¸ç”¨å‚æ•°**
- `-f, --filter filter` : è¿‡æ»¤è¾“å‡ºçš„å†…å®¹ï¼› 
- `--limit int` ï¼šæŒ‡å®šæœç´¢å†…å®¹å±•ç¤ºä¸ªæ•°; 
- `--no-index` : ä¸æˆªæ–­è¾“å‡ºå†…å®¹ï¼› 
- --no-trunc ï¼šä¸æˆªæ–­è¾“å‡ºå†…å®¹ï¼›

### Inspect æ£€è§†é•œåƒ

é€šè¿‡ `docker inspect` å‘½ä»¤ï¼Œæˆ‘ä»¬å¯ä»¥è·å–é•œåƒçš„è¯¦ç»†ä¿¡æ¯ï¼Œå…¶ä¸­ï¼ŒåŒ…æ‹¬åˆ›å»ºè€…ï¼Œå„å±‚çš„æ•°å­—æ‘˜è¦ç­‰ã€‚

`docker inspect` è¿”å›çš„æ˜¯ JSON æ ¼å¼çš„ä¿¡æ¯ï¼Œå¦‚æœæ‚¨æƒ³è·å–å…¶ä¸­æŒ‡å®šçš„ä¸€é¡¹å†…å®¹ï¼Œå¯ä»¥é€šè¿‡ -f æ¥æŒ‡ å®šï¼Œå¦‚è·å–é•œåƒå¤§å°

```bash
$ docker inspect tomcat:9.0.20-jre8-alpine 
$ docker inspect -f {{".Size"}} tomcat:9.0.20-jre8-alpine
```

### History é•œåƒå±‚ä¿¡æ¯

ä»å‰é¢çš„å‘½ä»¤ä¸­ï¼Œæˆ‘ä»¬äº†è§£åˆ°ï¼Œä¸€ä¸ªé•œåƒæ˜¯ç”±å¤šä¸ªå±‚ç»„æˆçš„ï¼Œé‚£ä¹ˆï¼Œæˆ‘ä»¬è¦å¦‚ä½•çŸ¥é“å„ä¸ªå±‚çš„å…·ä½“å†…å®¹ å‘¢ï¼Ÿ 

é€šè¿‡ docker history å‘½ä»¤ï¼Œå¯ä»¥åˆ—å‡ºå„ä¸ªå±‚çš„åˆ›å»ºä¿¡æ¯ï¼Œä¾‹å¦‚ï¼šæŸ¥çœ‹ tomcat:9.0.20-jre8-alpine çš„å„å±‚ ä¿¡æ¯
```bash
$ docker history tomcat:9.0.20-jre8-alpine
```

### Tag 
æ ‡è®°æœ¬åœ°é•œåƒ,å°†å…¶å½’å…¥æŸä¸€ä»“åº“.
```bash
$ docker tag tomcat:9.0.20-jre8-alpine lagou/tomcat:9
```

### rmi åˆ é™¤

å¯ä»¥é€šè¿‡åç§°åˆ é™¤é•œåƒä»¥å¤–,è¿˜å¯ä»¥é€šè¿‡IDåˆ é™¤.
ä¸€ä½†æŒ‡å®šäº†IDåˆ é™¤é•œåƒ,Dockerä¼šå°è¯•åˆ é™¤æ‰€æœ‰æŒ‡å‘è¯¥é•œåƒçš„æ ‡ç­¾,ç„¶åå†åˆ é™¤é•œåƒæœ¬èº«

```bash
$ docker rmi tomcat:9.0.20-jre8-alpine

$ docker image rm tomcat:9.0.20-jre8-alpine
// é€šè¿‡IDåˆ é™¤é•œåƒ
$ docker rmi ee7cbd482336
```

**å¸¸ç”¨å‚æ•°**

| å‚æ•°          | æ„ä¹‰                               |
| ------------- | ---------------------------------- |
| `-f | -force` | å¼ºåˆ¶åˆ é™¤é•œåƒï¼Œå³ä¾¿æœ‰å®¹å™¨å¼•ç”¨è¯¥é•œåƒ |
| `-no-prune`   | ä¸è¦åˆ é™¤æœªå¸¦æ ‡ç­¾çš„çˆ¶é•œåƒ           | 

**æµ‹è¯•**

ç¬¬ä¸€æ¬¡è¯•éªŒ
```bash
æ ¹æ®tomcat:9.0.20-jre8-alpineé•œåƒé‡æ–°æ‰“ä¸€ä¸ªæ–°çš„tag 
$docker tag tomcat:9.0.20-jre8-alpine lagou/tomcat:9 

é€šè¿‡imageså‘½ä»¤æŸ¥çœ‹é•œåƒ 
$docker images 

é€šè¿‡imageçš„IDåˆ é™¤é•œåƒ 
$docker rmi 387f9d021d3a 

é”™è¯¯ä¿¡æ¯å¦‚ä¸‹ï¼š Error response from daemon: conflict: unable to delete 387f9d021d3a (must be forced) - image is referenced in multiple repositories
```

ç¬¬äºŒæ¬¡è¯•éªŒ
```bash
æ ¹æ®tomcat:9.0.20-jre8-alpineé•œåƒé‡æ–°æ‰“ä¸¤ä¸ªä¸ªæ–°çš„tag 
$docker tag tomcat:9.0.20-jre8-alpine lagou/tomcat:9 
$docker tag tomcat:9.0.20-jre8-alpine lagou/tomcat:9.1 

æ ¹æ®imageåç§°åˆ é™¤tomcat:9.0.20-jre8-alpine 
$docker rmi tomcat:9.0.20-jre8-alpine 

é€šè¿‡imageçš„IDåˆ é™¤é•œåƒ 
$docker rmi 387f9d021d3a 

é”™è¯¯ä¿¡æ¯å¦‚ä¸‹ï¼š Error response from daemon: conflict: unable to delete 387f9d021d3a (must be forced) - image is referenced in multiple repositories
```

**æ€»ç»“**
-	æ¨èé€šè¿‡imageçš„åç§°åˆ é™¤é•œåƒ 
-	imageçš„IDåœ¨ç»ˆç«¯é•¿åº¦æœªå®Œå…¨æ˜¾ç¤ºï¼ŒIDå€¼ä¼šå‡ºç°é‡å¤

**åˆ é™¤é•œåƒçš„é™åˆ¶**
åˆ é™¤é•œåƒå¾ˆç®€å•ï¼Œä½†ä¹Ÿä¸æ˜¯æˆ‘ä»¬ä½•æ—¶ä½•åœ°éƒ½èƒ½åˆ é™¤çš„ï¼Œå®ƒå­˜åœ¨ä¸€äº›é™åˆ¶æ¡ä»¶ã€‚å½“é€šè¿‡è¯¥é•œåƒåˆ›å»ºçš„å®¹å™¨ æœªè¢«é”€æ¯æ—¶ï¼Œé•œåƒæ˜¯æ— æ³•è¢«åˆ é™¤çš„ã€‚ä¸ºäº†éªŒè¯è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬æ¥åšä¸ªè¯•éªŒã€‚

**æ­£ç¡®åšæ³•**
1.	å…ˆåˆ é™¤å¼•ç”¨è¿™ä¸ªé•œåƒçš„å®¹å™¨ï¼› 
2.	å†åˆ é™¤è¿™ä¸ªé•œåƒï¼›

### Prune æ¸…ç†é•œåƒ

æˆ‘ä»¬åœ¨ä½¿ç”¨ Docker ä¸€æ®µæ—¶é—´åï¼Œç³»ç»Ÿä¸€èˆ¬éƒ½ä¼šæ®‹å­˜ä¸€äº›ä¸´æ—¶çš„ã€æ²¡æœ‰è¢«ä½¿ç”¨çš„é•œåƒæ–‡ä»¶ï¼Œå¯ä»¥é€šè¿‡ä»¥ ä¸‹å‘½ä»¤è¿›è¡Œæ¸…ç†ã€‚æ‰§è¡Œå®Œå‘½ä»¤åï¼Œè¿˜æ˜¯å‘Šè¯‰æˆ‘ä»¬é‡Šæ”¾äº†å¤šå°‘å­˜å‚¨ç©ºé—´ï¼

```bash
$ docker image prune
```

**å¸¸ç”¨å‚æ•°**

| å‚æ•°         | æ„ä¹‰                                     |
| ------------ | ---------------------------------------- |
| `-a|--all`   | åˆ é™¤æ‰€æœ‰æ²¡æœ‰ç”¨çš„é•œåƒï¼Œè€Œä¸ä»…ä»…æ˜¯ä¸´æ—¶æ–‡ä»¶ |
| `-f|--force` | å¼ºåˆ¶åˆ é™¤é•œåƒæ–‡ä»¶ï¼Œæ— éœ€å¼¹å‡ºæç¤ºç¡®è®¤       | 
