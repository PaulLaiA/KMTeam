---
date: 2021-11-05
tags: ["#SpringFramework/#SpringBoot"]
aliases: []
---

# Metadata

**Title** :: Java åŸºç¤ç­†è¨˜æ¨¡æ¿

**Author** :: #Matthew 

**Classification** :: #Learn #Java #Basic #SpringFramework/#SpringBoot 

**Status** :: #ğŸŒ±

**Type** :: #Note

**Previous** ::

**ParentNode** :: [[Study_Matthew/SpringBoot/SpringBoot]]

---

# 1. SpringBoot æ‡‰ç”¨å›é¡§
## 1.1 ç´„å®šå„ªæ–¼é…ç½®
æ¦‚å¿µï¼šç´„å®šå„ªæ–¼é…ç½®(Convention over Configuration)ï¼Œåˆç¨±æŒ‰ç´„å®šç·¨ç¨‹ï¼Œæ˜¯ä¸€ç¨®è»Ÿä»¶è¨­è¨ˆè¦ç¯„ã€‚

æœ¬è³ªä¸Šæ˜¯å°ç³»çµ±ã€é¡åº«æˆ–æ¡†æ¶ä¸­ä¸€äº›æ±è¥¿å‡å®šä¸€å€‹å¤§çœ¾åŒ–åˆç†çš„é»˜èªå€¼(ç¼ºçœå€¼)ã€‚

ä¾‹å¦‚åœ¨æ¨¡å‹ä¸­å­˜åœ¨ä¸€å€‹åç‚º User çš„é¡ï¼Œé‚£éº¼å°æ‡‰åˆ°æ•¸æ“šåº«æœƒå­˜åœ¨ä¸€å€‹åç‚º user çš„è¡¨ï¼Œæ­¤æ™‚ç„¡éœ€åšé¡å¤–çš„é…ç½®ï¼Œåªæœ‰åœ¨åé›¢é€™å€‹ç´„å®šæ™‚æ‰éœ€è¦åšç›¸é—œçš„é…ç½®ï¼ˆä¾‹å¦‚ä½ æƒ³å°‡è¡¨åå‘½åç‚º t_user ç­‰é user æ™‚æ‰éœ€è¦å¯«é—œæ–¼é€™å€‹åå­—çš„é…ç½®ï¼‰ã€‚

å¦‚æœæ‰€ç”¨å·¥å…·çš„ç´„å®šèˆ‡ä½ çš„æœŸå¾…ç›¸ç¬¦ï¼Œä¾¿å¯çœå»é…ç½®ï¼›åä¹‹ï¼Œä½ å¯ä»¥é…ç½®ä¾†é”åˆ°ä½ æ‰€æœŸå¾…çš„æ–¹å¼ã€‚

ç°¡å–®ä¾†èªªå°±æ˜¯å‡å¦‚ä½ æ‰€æœŸå¾…çš„é…ç½®èˆ‡ç´„å®šçš„é…ç½®ä¸€è‡´ï¼Œé‚£éº¼å°±å¯ä»¥ä¸åšä»»ä½•é…ç½®ï¼Œç´„å®šä¸ç¬¦åˆæœŸå¾…æ™‚æ‰éœ€è¦å°ç´„å®šé€²è¡Œæ›¿æ›é…ç½®ã€‚

å¥½è™•ï¼šå¤§å¤§æ¸›å°‘äº†é…ç½®é …

## 1.2 SpringBoot æ¦‚å¿µ
### 1.2.1 ä»€éº¼æ˜¯ SpringBoot
spring å®˜æ–¹çš„ç¶²ç«™ï¼šhttps://spring.io/

![[Study_Matthew/SpringBoot/_annex/Pasted image 20211105113307.png]]

ç¿»è­¯ï¼šé€šé Spring Bootï¼Œå¯ä»¥è¼•é¬†åœ°å‰µå»ºç¨ç«‹çš„ï¼ŒåŸºæ–¼ç”Ÿç”¢ç´šåˆ¥çš„åŸºæ–¼ Spring çš„æ‡‰ç”¨ç¨‹åºï¼Œä¸¦ä¸”å¯ä»¥â€œé‹è¡Œâ€å®ƒå€‘

å…¶å¯¦ Spring Boot çš„è¨­è¨ˆæ˜¯ç‚ºäº†è®“ä½ ç›¡å¯èƒ½å¿«çš„è·‘èµ·ä¾† Spring æ‡‰ç”¨ç¨‹åºä¸¦ä¸”ç›¡å¯èƒ½æ¸›å°‘ä½ çš„é…ç½®æ–‡ä»¶ã€‚

**ä»¥ä¸‹å…§å®¹ä¾†è‡ªç™¾åº¦ç™¾ç§‘**

SpringBoot æ˜¯ç”± Pivotal åœ˜éšŠåœ¨ 2013 å¹´é–‹å§‹ç ”ç™¼ã€2014 å¹´ 4 æœˆç™¼å¸ƒç¬¬ä¸€å€‹ç‰ˆæœ¬çš„å…¨æ–°é–‹æºçš„è¼•é‡ç´šæ¡†æ¶ã€‚å®ƒåŸºæ–¼ Spring4.0 è¨­è¨ˆï¼Œä¸åƒ…ç¹¼æ‰¿äº† Spring æ¡†æ¶åŸæœ‰çš„å„ªç§€ç‰¹æ€§ï¼Œè€Œä¸”é‚„é€šéç°¡åŒ–é…ç½®ä¾†é€²ä¸€æ­¥ç°¡åŒ–äº† Spring æ‡‰ç”¨çš„æ•´å€‹æ­å»ºå’Œé–‹ç™¼éç¨‹ã€‚å¦å¤– SpringBoot é€šéé›†æˆå¤§é‡çš„æ¡†æ¶ä½¿å¾—ä¾è³´åŒ…çš„ç‰ˆæœ¬è¡çªï¼Œä»¥åŠå¼•ç”¨çš„ä¸ç©©å®šæ€§ç­‰å•é¡Œå¾—åˆ°äº†å¾ˆå¥½çš„è§£æ±º

### 1.2.2 SpringBoot ä¸»è¦ç‰¹æ€§
1. SpringBoot Starterï¼šä»–å°‡å¸¸ç”¨çš„ä¾è³´åˆ†çµ„é€²è¡Œäº†æ•´åˆï¼Œå°‡å…¶åˆä½µåˆ°ä¸€å€‹ä¾è³´ä¸­ï¼Œé€™æ¨£å°±å¯ä»¥ä¸€æ¬¡æ€§æ·»åŠ åˆ°é …ç›®çš„ Maven æˆ– Gradle æ§‹å»ºä¸­ï¼›
2. ä½¿ç·¨ç¢¼è®Šå¾—ç°¡å–®ï¼ŒSpringBoot æ¡ç”¨ JavaConfig çš„æ–¹å¼å° Spring é€²è¡Œé…ç½®ï¼Œä¸¦ä¸”æä¾›äº†å¤§é‡çš„è¨»è§£ï¼Œæ¥µå¤§çš„æé«˜äº†å·¥ä½œæ•ˆç‡ã€‚
3. è‡ªå‹•é…ç½®ï¼šSpringBoot çš„è‡ªå‹•é…ç½®ç‰¹æ€§åˆ©ç”¨äº† Spring å°æ¢ä»¶åŒ–é…ç½®çš„æ”¯æŒï¼Œåˆç†åœ°æ¨æ¸¬æ‡‰ç”¨æ‰€éœ€çš„ bean ä¸¦è‡ªå‹•åŒ–é…ç½®ä»–å€‘ï¼›
4. ä½¿éƒ¨ç½²è®Šå¾—ç°¡å–®ï¼ŒSpringBoot å…§ç½®äº†ä¸‰ç¨® Servlet å®¹å™¨ï¼ŒTomcatï¼ŒJetty,undertow.æˆ‘å€‘åªéœ€è¦ä¸€å€‹ Java çš„é‹è¡Œç’°å¢ƒå°±å¯ä»¥è·‘ SpringBoot çš„é …ç›®äº†ï¼ŒSpringBoot çš„é …ç›®å¯ä»¥æ‰“æˆä¸€å€‹ jar åŒ…ã€‚


## 1.3 SpringBoot æ¡ˆä¾‹å¯¦ç¾
### 1.3.1 æ¡ˆä¾‹å¯¦ç¾
**æ¡ˆä¾‹éœ€æ±‚**ï¼šä½¿ç”¨ Spring Initializr æ–¹å¼æ§‹å»º Spring Boot é …ç›®ï¼Œä¸¦è«‹æ±‚ Controller ä¸­çš„ç›®æ¨™æ–¹æ³•ï¼Œå°‡è¿”å›å€¼éŸ¿æ‡‰åˆ°é é¢

1. ä½¿ç”¨ Spring Initializr æ–¹å¼æ§‹å»º Spring Boot é …ç›®
	
	æœ¬è³ªä¸Šèªªï¼ŒSpring Initializr æ˜¯ä¸€å€‹ Web æ‡‰ç”¨ï¼Œå®ƒæä¾›äº†ä¸€å€‹åŸºæœ¬çš„é …ç›®çµæ§‹ï¼Œèƒ½å¤ å¹«åŠ©æˆ‘å€‘å¿«é€Ÿæ§‹å»ºä¸€å€‹åŸºç¤çš„ Spring Boot é …ç›®
	
	![[Study_Matthew/SpringBoot/_annex/Pasted image 20211105113804.png]]
	
	Project SDKâ€ç”¨æ–¼è¨­ç½®å‰µå»ºé …ç›®ä½¿ç”¨çš„ JDK ç‰ˆæœ¬ï¼Œé€™è£¡ï¼Œä½¿ç”¨ä¹‹å‰åˆå§‹åŒ–è¨­ç½®å¥½çš„ JDK ç‰ˆæœ¬å³å¯ï¼›åœ¨â€œChoose Initializr Service URLï¼ˆé¸æ“‡åˆå§‹åŒ–æœå‹™åœ°å€ï¼‰â€ä¸‹ä½¿ç”¨é»˜èªçš„åˆå§‹åŒ–æœå‹™åœ°å€â€œhttps://start.spring.ioâ€é€²è¡Œ Spring Boot é …ç›®å‰µå»ºï¼ˆæ³¨æ„ä½¿ç”¨å¿«é€Ÿæ–¹å¼å‰µå»º Spring Boot é …ç›®æ™‚ï¼Œæ‰€åœ¨ä¸»æ©Ÿé ˆåœ¨è¯ç¶²ç‹€æ…‹ä¸‹ï¼‰
	
	![[Study_Matthew/SpringBoot/_annex/Pasted image 20211105113932.png]]
	
	Spring Boot é …ç›®å°±å‰µå»ºå¥½äº†ã€‚å‰µå»ºå¥½çš„ Spring Boot é …ç›®çµæ§‹å¦‚åœ–ï¼š
	
	![[Study_Matthew/SpringBoot/_annex/Pasted image 20211105114001.png]]
	
	ä½¿ç”¨ Spring Initializr æ–¹å¼æ§‹å»ºçš„ Spring Boot é …ç›®æœƒé»˜èªç”Ÿæˆé …ç›®å•Ÿå‹•é¡ã€å­˜æ”¾å‰ç«¯éœæ…‹è³‡æºå’Œé é¢çš„æ–‡ä»¶å¤¾ã€ç·¨å¯«é …ç›®é…ç½®çš„é…ç½®æ–‡ä»¶ä»¥åŠé€²è¡Œé …ç›®å–®å…ƒæ¸¬è©¦çš„æ¸¬è©¦é¡
	
2. å‰µå»º Controller
	
	com.lagou åŒ…ä¸‹å‰µå»ºåç¨±ç‚º controller çš„åŒ…ï¼Œåœ¨è©²åŒ…ä¸‹å‰µå»ºä¸€å€‹è«‹æ±‚è™•ç†æ§åˆ¶é¡ HelloControllerï¼Œä¸¦ç·¨å¯«ä¸€å€‹è«‹æ±‚è™•ç†æ–¹æ³• (æ³¨æ„ï¼šå°‡é …ç›®å•Ÿå‹•é¡ SpringBootDemoApplication ç§»å‹•åˆ° com.lagou åŒ…ä¸‹)
	```java
	@RestController // è¯¥æ³¨è§£ä¸ºç»„åˆæ³¨è§£ï¼Œç­‰åŒäº Spring ä¸­@Controller+@ResponseBody æ³¨è§£
	public class DemoController {
	 @RequestMapping("/demo")
	 public String demo(){
	  return "hello springBoot";
	 }
	}
	```
3. é‹è¡Œé …ç›®
	
	é‹è¡Œä¸»ç¨‹åºå•Ÿå‹•é¡ SpringbootDemoApplicationï¼Œé …ç›®å•Ÿå‹•æˆåŠŸå¾Œï¼Œåœ¨æ§åˆ¶å°ä¸Šæœƒç™¼ç¾ Spring Boot é …ç›®é»˜èªå•Ÿå‹•çš„ç«¯å£è™Ÿç‚º 8080ï¼Œæ­¤æ™‚ï¼Œå¯ä»¥åœ¨ç€è¦½å™¨ä¸Šè¨ªå•â€œhttp://localhost:8080/helloâ€
	
	![[Study_Matthew/SpringBoot/_annex/Pasted image 20211105115039.png]]
	
	é é¢è¼¸å‡ºçš„å…§å®¹æ˜¯â€œhello Spring Bootâ€ï¼Œè‡³æ­¤ï¼Œæ§‹å»º Spring Boot é …ç›®å°±å®Œæˆäº† 
	
	**é™„ï¼šè§£æ±ºä¸­æ–‡äº‚ç¢¼ï¼š**
	
	è§£æ±ºæ–¹æ³•ä¸€ï¼š
	```java
	@RequestMapping(produces = "application/json; charset=utf-8")
	```

	è§£æ±ºæ–¹æ³•äºŒï¼š
	```txt
	#è¨­ç½®éŸ¿æ‡‰ç‚º utf-8
	spring.http.encoding.force-response=true
	```

### 1.3.2 ç–‘å•
1. starter æ˜¯ä»€éº¼ï¼Ÿæˆ‘å€‘å¦‚ä½•å»ä½¿ç”¨é€™äº› starterï¼Ÿ
2. ç‚ºä»€éº¼åŒ…æƒæåªæœƒæƒææ ¸å¿ƒå•Ÿå‹•é¡æ‰€åœ¨çš„åŒ…åŠå…¶å­åŒ…
3. åœ¨ springBoot å•Ÿå‹•çš„éç¨‹ä¸­ï¼Œæ˜¯å¦‚ä½•å®Œæˆè‡ªå‹•è£é…çš„ï¼Ÿ
4. å…§åµŒ Tomcat æ˜¯å¦‚ä½•è¢«å‰µå»ºåŠå•Ÿå‹•çš„ï¼Ÿ
5. ä½¿ç”¨äº† Web å ´æ™¯å°æ‡‰çš„ starterï¼Œspringmvc æ˜¯å¦‚ä½•è‡ªå‹•è£é…ï¼Ÿ
	
ï¼ˆä¿ç•™ç–‘å•ï¼šåœ¨æºç¢¼å‰–æéƒ¨åˆ†ï¼Œä¸»è¦å°‡ä»¥ä¸Šç–‘å•é€²è¡Œè§£ç­”ï¼‰


## 1.4 ç†±éƒ¨ç½²
åœ¨é–‹ç™¼é …ç›®éç¨‹ä¸­ï¼Œç•¶ä¿®æ”¹äº†æŸäº›ä»£ç¢¼å¾Œéœ€è¦æœ¬åœ°é©—è­‰æ™‚ï¼Œéœ€è¦é‡å•Ÿæœ¬åœ°æœå‹™é€²è¡Œé©—è­‰ï¼Œå•Ÿå‹•é€™å€‹é …ç›®ï¼Œå¦‚æœé …ç›®é¾å¤§çš„è©±é‚„æ˜¯éœ€è¦è¼ƒé•·æ™‚é–“çš„ï¼Œspring é–‹ç™¼åœ˜éšŠç‚ºæˆ‘å€‘å¸¶ä¾†äº†ä¸€å€‹æ’ä»¶ï¼šspring-boot devtoolsï¼Œå¾ˆå¥½çš„è§£æ±ºäº†æœ¬åœ°é©—è­‰ç·©æ…¢çš„å•é¡Œã€‚

### 1.4.1 ç†±éƒ¨ç½²å¯¦ç¾æ¼”ç¤º
1. æ·»åŠ  spring-boot-devtools ç†±éƒ¨ç½²ä¾è³´å•Ÿå‹•å™¨
	
	åœ¨ Spring Boot é …ç›®é€²è¡Œç†±éƒ¨ç½²æ¸¬è©¦ä¹‹å‰ï¼Œéœ€è¦å…ˆåœ¨é …ç›®çš„ pom.xml æ–‡ä»¶ä¸­æ·»åŠ  spring-boot-devtools ç†±éƒ¨ç½²ä¾è³´å•Ÿå‹•å™¨:
	```xml
	<!-- å¼•å…¥çƒ­éƒ¨ç½²ä¾èµ– -->
	<dependency>
	<groupId>org.springframework.boot</groupId>
	<artifactId>spring-boot-devtools</artifactId>
	</dependency>
	```

	ç”±æ–¼ä½¿ç”¨çš„æ˜¯ IDEA é–‹ç™¼å·¥å…·ï¼Œæ·»åŠ ç†±éƒ¨ç½²ä¾è³´å¾Œå¯èƒ½æ²’æœ‰ä»»ä½•æ•ˆæœï¼Œæ¥ä¸‹ä¾†é‚„éœ€è¦é‡å° IDEA é–‹ç™¼å·¥å…·é€²è¡Œç†±éƒ¨ç½²ç›¸é—œçš„åŠŸèƒ½è¨­ç½®

2. IDEA å·¥å…·ç†±éƒ¨ç½²è¨­ç½®
 
	 é¸æ“‡ IDEA å·¥å…·ç•Œé¢çš„ã€Fileã€‘->ã€Settingsã€‘é¸é …ï¼Œæ‰“é–‹ Compiler é¢æ¿è¨­ç½®é é¢

	![[Study_Matthew/SpringBoot/_annex/Pasted image 20211105120100.png]]

	é¸æ“‡ Build ä¸‹çš„ Compiler é¸é …ï¼Œåœ¨å³å´å‹¾é¸â€œBuild project automaticallyâ€é¸é …å°‡é …ç›®è¨­ç½®ç‚ºè‡ªå‹•ç·¨è­¯ï¼Œå–®æ“Šã€Applyã€‘â†’ã€OKã€‘æŒ‰éˆ•ä¿å­˜è¨­ç½®

	åœ¨é …ç›®ä»»æ„é é¢ä¸­ä½¿ç”¨çµ„åˆå¿«æ·éµâ€œCtrl+Shift+Alt+/â€æ‰“é–‹ Maintenance é¸é …æ¡†ï¼Œé¸ä¸­ä¸¦æ‰“é–‹ Registry é é¢ï¼Œå…·é«”å¦‚åœ– 1-17 æ‰€ç¤º

	![[Study_Matthew/SpringBoot/_annex/Pasted image 20211105120523.png]]
	
	åˆ—è¡¨ä¸­æ‰¾åˆ°â€œcompiler.automake.allow.when.app.runningâ€ï¼Œå°‡è©²é¸é …å¾Œçš„ Value å€¼å‹¾é¸ï¼Œç”¨æ–¼æŒ‡å®š IDEA å·¥å…·åœ¨ç¨‹åºé‹è¡Œéç¨‹ä¸­è‡ªå‹•ç·¨è­¯ï¼Œæœ€å¾Œå–®æ“Šã€Closeã€‘æŒ‰éˆ•å®Œæˆè¨­ç½®
	
3. ç†±éƒ¨å±¬æ•ˆæœæ¸¬è©¦
	
	å•Ÿå‹• chapter01http://localhost:8080/hello
	
	![[Study_Matthew/SpringBoot/_annex/Pasted image 20211105120810.png]]
	
	é é¢åŸå§‹è¼¸å‡ºçš„å…§å®¹æ˜¯â€œhello Spring Bootâ€ã€‚ç‚ºäº†æ¸¬è©¦é…ç½®çš„ç†±éƒ¨ç½²æ˜¯å¦æœ‰æ•ˆï¼Œæ¥ä¸‹ä¾†ï¼Œåœ¨ä¸é—œé–‰ç•¶å‰é …ç›®çš„æƒ…æ³ä¸‹ï¼Œå°‡ DemoController é¡ä¸­çš„è«‹æ±‚è™•ç†æ–¹æ³• hello()çš„è¿”å›å€¼ä¿®æ”¹ç‚ºâ€œä½ å¥½ï¼ŒSpring Bootâ€ä¸¦ä¿å­˜ï¼ŒæŸ¥çœ‹æ§åˆ¶å°ä¿¡æ¯æœƒç™¼ç¾é …ç›®èƒ½å¤ è‡ªå‹•æ§‹å»ºå’Œç·¨è­¯ï¼Œèªªæ˜é …ç›®ç†±éƒ¨ç½²ç”Ÿæ•ˆ

	![[Study_Matthew/SpringBoot/_annex/Pasted image 20211105120848.png]]
	
	å¯ä»¥çœ‹å‡ºï¼Œç€è¦½å™¨è¼¸å‡ºäº†â€œä½ å¥½ï¼ŒSpring Bootâ€ï¼Œèªªæ˜é …ç›®ç†±éƒ¨ç½²é…ç½®æˆåŠŸ 
	
### 1.4.2 ç†±éƒ¨ç½²åŸç†åˆ†æ
è©²åŸç†å…¶å¯¦å¾ˆå¥½èªªæ˜ï¼Œå°±æ˜¯æˆ‘å€‘åœ¨ç·¨è¼¯å™¨ä¸Šå•Ÿå‹•é …ç›®ï¼Œç„¶å¾Œæ”¹å‹•ç›¸é—œçš„ä»£ç¢¼ï¼Œç„¶å¾Œç·¨è¼¯å™¨è‡ªå‹•è§¸ç™¼ç·¨è­¯æ›¿æ›æ‰æ­·å²çš„.class æ–‡ä»¶å¾Œï¼Œé …ç›®æª¢æ¸¬åˆ°æœ‰æ–‡ä»¶è®Šæ›´å¾Œæœƒé‡å•Ÿ srpring-boot é …ç›®ã€‚

å¯ä»¥çœ‹çœ‹å®˜ç¶²çš„è§¸ç™¼æè¿°ï¼š

![[Study_Matthew/SpringBoot/_annex/Pasted image 20211105121000.png]]

å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘å€‘å¼•å…¥äº†æ’ä»¶å¾Œï¼Œæ’ä»¶æœƒç›£æ§æˆ‘å€‘ classpath çš„è³‡æºè®ŠåŒ–ï¼Œç•¶ classpath æœ‰è®ŠåŒ–å¾Œï¼Œæœƒè§¸ç™¼é‡å•Ÿ

![[Study_Matthew/SpringBoot/_annex/Pasted image 20211105121008.png]]

é€™è£¡æåˆ°äº†ï¼Œè©²æ’ä»¶é‡å•Ÿå¿«é€Ÿçš„åŸå› ï¼šé€™è£¡å°é¡åŠ è¼‰æ¡ç”¨äº†å…©ç¨®é¡åŠ è¼‰å™¨ï¼Œå°æ–¼ç¬¬ä¸‰æ–¹ jar åŒ…æ¡ç”¨ base classloader ä¾†åŠ è¼‰ï¼Œå°æ–¼é–‹ç™¼äººå“¡è‡ªå·±é–‹ç™¼çš„ä»£ç¢¼å‰‡ä½¿ç”¨ restartClassLoader ä¾†é€²è¡ŒåŠ è¼‰ï¼Œé€™ä½¿å¾—æ¯”åœæ‰æœå‹™é‡å•Ÿè¦å¿«çš„å¤šï¼Œå› ç‚ºä½¿ç”¨æ’ä»¶åªæ˜¯é‡å•Ÿé–‹ç™¼äººå“¡ç·¨å¯«çš„ä»£ç¢¼éƒ¨åˆ†ã€‚

é€™é‚Šåšå€‹ç°¡å–®çš„é©—è­‰ï¼š
```java
@Component
public class Devtools implements InitializingBean {
 private static final Logger log = LoggerFactory.getLogger(Devtools.class);
 @Override
 public void afterPropertiesSet() throws Exception {
  log.info("guava-jar classLoader: " +
  DispatcherServlet.class.getClassLoader().toString());
  log.info("Devtools ClassLoader: " +
  this.getClass().getClassLoader().toString());
 }
}
```

é€™é‚Šå…ˆå»é™¤ spring-boot-devtools æ’ä»¶ï¼Œè·‘ä¸‹å·¥ç¨‹ï¼š

![[Study_Matthew/SpringBoot/_annex/Pasted image 20211105121153.png]]

å¯ä»¥çœ‹åˆ°ï¼ŒDispatcherServletï¼ˆç¬¬ä¸‰æ–¹ jar åŒ…ï¼‰å’Œ Devtools(è‡ªå·±ç·¨å¯«çš„é¡)ä½¿ç”¨çš„éƒ½æ˜¯ AppClassLoader åŠ è¼‰çš„ã€‚

æˆ‘å€‘ç¾åœ¨åŠ ä¸Šæ’ä»¶ï¼Œç„¶å¾ŒåŸ·è¡Œä¸‹ä»£ç¢¼ï¼š

![[Study_Matthew/SpringBoot/_annex/Pasted image 20211105121221.png]]

ç™¼ç¾ç¬¬ä¸‰æ–¹çš„ jar åŒ…çš„é¡åŠ è¼‰å™¨ç¢ºå¯¦æ˜¯ä½¿ç”¨çš„ç³»çµ±çš„é¡åŠ è¼‰å™¨ï¼Œè€Œæˆ‘å€‘è‡ªå·±å¯«çš„ä»£ç¢¼çš„é¡åŠ è¼‰å™¨ç‚º RestartClassLoaderï¼Œä¸¦ä¸”æ¯æ¬¡é‡å•Ÿï¼Œé¡åŠ è¼‰å™¨çš„å¯¦ä¾‹éƒ½æœƒæ”¹è®Šã€‚

![[Study_Matthew/SpringBoot/_annex/Pasted image 20211105121249.png]]

![[Study_Matthew/SpringBoot/_annex/Pasted image 20211105121256.png]]

ä¸Šåœ–ç‚ºä»£ç¢¼ä¿®æ”¹å‰å¾Œé¡æ–‡ä»¶çš„è®Šæ›´ã€‚

### 1.4.3 æ’é™¤è³‡æº
æŸäº›è³‡æºåœ¨æ›´æ”¹å¾Œä¸ä¸€å®šéœ€è¦è§¸ç™¼é‡æ–°å•Ÿå‹•ã€‚ä¾‹å¦‚ï¼ŒThymeleaf æ¨¡æ¿å¯ä»¥å°±åœ°ç·¨è¼¯ã€‚é»˜èªæƒ…æ³ä¸‹ï¼Œæ”¹è®Šè³‡æº /META-INF/maven ï¼Œ /META-INF/resources ï¼Œ /resources ï¼Œ /static ï¼Œ /public ï¼Œæˆ– /templates ä¸è§¸ç™¼é‡æ–°å•Ÿå‹•ï¼Œä½†ç¢ºæœƒè§¸ç™¼ç¾å ´é‡è£ã€‚å¦‚æœè¦è‡ªå®šç¾©é€™äº›æ’é™¤é …ï¼Œå‰‡å¯ä»¥ä½¿ç”¨è©² spring.devtools.restart.exclude å±¬æ€§ã€‚ä¾‹å¦‚ï¼Œåƒ…æ’é™¤ /static ï¼Œ /public æ‚¨å°‡è¨­ç½®ä»¥ä¸‹å±¬æ€§ï¼š
```properties
spring.devtools.restart.exclude=static/**,public/**
```

## 1.5 å…¨å±€é…ç½®æ–‡ä»¶
### 1.5.1 å…¨å±€é…ç½®æ–‡ä»¶æ¦‚è¿°åŠå„ªå…ˆç´š
å…¨å±€é…ç½®æ–‡ä»¶èƒ½å¤ å°ä¸€äº›é»˜èªé…ç½®å€¼é€²è¡Œä¿®æ”¹åŠè‡ªå®šç¾©é…ç½®ã€‚

Spring Boot ä½¿ç”¨ä¸€å€‹ application.properties æˆ–è€… application.yaml çš„æ–‡ä»¶ä½œç‚ºå…¨å±€é…ç½®æ–‡ä»¶

![[Study_Matthew/SpringBoot/_annex/Pasted image 20211105121441.png]]

ä¹Ÿå¯ä»¥å¾ ConfigFileApplicationListener é€™é¡ä¾¿å¯çœ‹å‡ºï¼Œå…¶ä¸­ DEFAULT_SEARCH_LOCATIONS å±¬æ€§è¨­ç½®äº†åŠ è¼‰çš„ç›®éŒ„ï¼š

ç¿»è­¯æˆæ–‡ä»¶ç³»çµ±ï¼š
```properties
â€“file:./config/
â€“file:./
â€“classpath:/config/
â€“classpath:/
```

ç¿»è­¯æˆèªè¨€å¦‚ä¸‹ï¼ˆ æŒ‰ç…§å„ªå…ˆç´šå¾é«˜åˆ°ä½çš„é †åº ï¼‰ï¼š
1. å…ˆå»é …ç›®æ ¹ç›®éŒ„æ‰¾ config æ–‡ä»¶å¤¾ä¸‹æ‰¾é…ç½®æ–‡ä»¶ä»¶
2. å†å»æ ¹ç›®éŒ„ä¸‹æ‰¾é…ç½®æ–‡ä»¶
3. å» resources ä¸‹æ‰¾ cofnig æ–‡ä»¶å¤¾ä¸‹æ‰¾é…ç½®æ–‡ä»¶
4. å» resources ä¸‹æ‰¾é…ç½®æ–‡ä»¶

![[Study_Matthew/SpringBoot/_annex/Pasted image 20211105121553.png]]

æ•´å€‹è¨­è¨ˆéå¸¸å·§å¦™ã€‚ SpringBoot æœƒå¾é€™å››å€‹ä½ç½®å…¨éƒ¨åŠ è¼‰ä¸»é…ç½®æ–‡ä»¶ï¼Œå¦‚æœé«˜å„ªå…ˆç´šä¸­é…ç½®æ–‡ä»¶å±¬æ€§èˆ‡ä½å„ªå…ˆç´šé…ç½®æ–‡ä»¶ä¸è¡çªçš„å±¬æ€§ï¼Œå‰‡æœƒå…±åŒå­˜åœ¨â€” äº’è£œé…ç½® ã€‚

SpringBoot æœƒåŠ è¼‰å…¨éƒ¨ä¸»é…ç½®æ–‡ä»¶ï¼›äº’è£œé…ç½®ï¼›

	å‚™è¨»ï¼š
	é€™è£¡èªªçš„é…ç½®æ–‡ä»¶ï¼Œéƒ½é‚„æ˜¯é …ç›®è£¡é¢ã€‚æœ€çµ‚éƒ½æœƒè¢«æ‰“é€² jar åŒ…è£¡é¢çš„ï¼Œéœ€è¦æ³¨æ„ã€‚
	1ã€å¦‚æœåŒä¸€å€‹ç›®éŒ„ä¸‹ï¼Œæœ‰ application.yml ä¹Ÿæœ‰ application.propertiesï¼Œé»˜èªå…ˆè®€å– application.propertiesã€‚
	2ã€å¦‚æœåŒä¸€å€‹é…ç½®å±¬æ€§ï¼Œåœ¨å¤šå€‹é…ç½®æ–‡ä»¶éƒ½é…ç½®äº†ï¼Œé»˜èªä½¿ç”¨ç¬¬ 1 å€‹è®€å–åˆ°çš„ï¼Œå¾Œé¢è®€å–çš„ä¸è¦†è“‹å‰é¢è®€å–åˆ°çš„ã€‚
	3ã€å‰µå»º SpringBoot é …ç›®æ™‚ï¼Œä¸€èˆ¬çš„é…ç½®æ–‡ä»¶æ”¾ç½®åœ¨â€œé …ç›®çš„ resources ç›®éŒ„ä¸‹â€

å¦‚æœæˆ‘å€‘çš„é…ç½®æ–‡ä»¶åå­—ä¸å« application.properties æˆ–è€… application.ymlï¼Œå¯ä»¥é€šéä»¥ä¸‹åƒæ•¸ä¾†æŒ‡å®šé…ç½®æ–‡ä»¶çš„åå­—ï¼Œmyproject æ˜¯é…ç½®æ–‡ä»¶å
```cmd
$ java -jar myproject.jar --spring.config.name=myproject
```

æˆ‘å€‘åŒæ™‚ä¹Ÿå¯ä»¥æŒ‡å®šå…¶ä»–ä½ç½®çš„é…ç½®æ–‡ä»¶ä¾†ç”Ÿæ•ˆ

æŒ‡å®šé…ç½®æ–‡ä»¶å’Œé»˜èªåŠ è¼‰çš„é€™äº›é…ç½®æ–‡ä»¶å…±åŒèµ·ä½œç”¨å½¢æˆäº’è£œé…ç½®ã€‚

```cmd
java -jar run-0.0.1-SNAPSHOT.jar --
spring.config.location=D:/application.properties
```

æ¥ä¸‹ä¾†ï¼Œå°‡é‡å°é€™å…©ç¨®å…¨å±€é…ç½®æ–‡ä»¶ application.properties åŠ application.yml é€²è¡Œè¬›è§£ ï¼š

**çŸ¥è­˜é»è£œå……ï¼**

Spring Boot 2.4 æ”¹é€²äº†è™•ç† application.properties å’Œ application.yml é…ç½®æ–‡ä»¶çš„æ–¹å¼ï¼Œ

å¦‚æœæ˜¯ 2.4.0 ä¹‹å‰ç‰ˆæœ¬ï¼Œå„ªå…ˆç´š properties>yaml

ä½†æ˜¯å¦‚æœæ˜¯ 2.4.0 çš„ç‰ˆæœ¬ï¼Œå„ªå…ˆç´š yaml>properties

å¦‚æœæƒ³ç¹¼çºŒä½¿ç”¨ Spring Boot 2.3 çš„é…ç½®é‚è¼¯ï¼Œä¹Ÿå¯ä»¥é€šéåœ¨ application.properties æˆ–è€… application.yml é…ç½®æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹åƒæ•¸ï¼š
```properties
spring.config.use-legacy-processing = true
```


### 1.5.2 application.properties é…ç½®æ–‡ä»¶
ä½¿ç”¨ Spring Initializr æ–¹å¼æ§‹å»º Spring Boot é …ç›®æ™‚ï¼Œæœƒåœ¨ resource ç›®éŒ„ä¸‹è‡ªå‹•ç”Ÿæˆä¸€å€‹ç©ºçš„ application.properties æ–‡ä»¶ï¼ŒSpring Boot é …ç›®å•Ÿå‹•æ™‚æœƒè‡ªå‹•åŠ è¼‰ application.properties æ–‡ä»¶ã€‚

æˆ‘å€‘å¯ä»¥åœ¨ application.properties æ–‡ä»¶ä¸­å®šç¾© Spring Boot é …ç›®çš„ç›¸é—œå±¬æ€§ï¼Œç•¶ç„¶ï¼Œé€™äº›ç›¸é—œå±¬æ€§å¯ä»¥æ˜¯ç³»çµ±å±¬æ€§ã€ç’°å¢ƒè®Šé‡ã€å‘½ä»¤åƒæ•¸ç­‰ä¿¡æ¯ï¼Œä¹Ÿå¯ä»¥æ˜¯è‡ªå®šç¾©é…ç½®æ–‡ä»¶åç¨±å’Œä½ç½®
```properties
server.port=8081
spring.datasource.driver-class-name=com.mysql.jdbc.Driver
spring.config.name=application
```

æ¥ä¸‹ä¾†ï¼Œé€šéä¸€å€‹æ¡ˆä¾‹å° Spring Boot é …ç›®ä¸­ application.properties é…ç½®æ–‡ä»¶çš„å…·é«”ä½¿ç”¨é€²è¡Œè¬›è§£ 

æ¼”ç¤ºï¼š

é å…ˆæº–å‚™äº†å…©å€‹å¯¦é«”é¡æ–‡ä»¶ï¼Œå¾ŒçºŒæœƒæ¼”ç¤ºå°‡ application.properties é…ç½®æ–‡ä»¶ä¸­çš„è‡ªå®šç¾©é…ç½®å±¬æ€§æ³¨å…¥åˆ° Person å¯¦é«”é¡çš„å°æ‡‰å±¬æ€§ä¸­

1. å…ˆåœ¨é …ç›®çš„ com.lagou åŒ…ä¸‹å‰µå»ºä¸€å€‹ pojo åŒ…ï¼Œä¸¦åœ¨è©²åŒ…ä¸‹å‰µå»ºå…©å€‹å¯¦é«”é¡ Pet å’Œ Person
	
	```java
	public class Pet {
	  private String type;
	  private String name;
	  // çœç•¥å±æ€§ getXX()å’Œ setXX()æ–¹æ³•
	  // çœç•¥ toString()æ–¹æ³•
	}
	```

	```java
	@Component //ç”¨äºå°† Person ç±»ä½œä¸º Bean æ³¨å…¥åˆ° Spring å®¹å™¨ä¸­
	@ConfigurationProperties(prefix = "person")æ³¨è§£çš„ä½œç”¨æ˜¯å°†é…ç½®æ–‡ä»¶ä¸­ä»¥ person å¼€å¤´çš„å±æ€§å€¼é€šè¿‡ setXX()æ–¹æ³•æ³¨å…¥åˆ°å®ä½“ç±»å¯¹åº”å±æ€§ä¸­

	public class Person {
	 private int id; //id
	 private String name; //åç§°
	 private List hobby; //çˆ±å¥½
	 private String[] family; //å®¶åº­æˆå‘˜
	 private Map map;
	 private Pet pet; //å® ç‰©
	 // çœç•¥å±æ€§ getXX()å’Œ setXX()æ–¹æ³•
	 // çœç•¥ toString()æ–¹æ³•
	}
	```

	@ConfigurationProperties(prefix = "person") //å°‡é…ç½®æ–‡ä»¶ä¸­ä»¥ person é–‹é ­çš„å±¬æ€§æ³¨å…¥åˆ°è©²é¡ä¸­
	
	@Component è¨»è§£çš„ä½œç”¨æ˜¯å°‡ç•¶å‰è¨»å…¥å±¬æ€§å€¼çš„ Person é¡å°åƒä½œç‚º Bean çµ„ä»¶æ”¾åˆ° Spring å®¹å™¨ä¸­ï¼Œåªæœ‰é€™æ¨£æ‰èƒ½è¢«@ConfigurationProperties è¨»è§£é€²è¡Œè³¦å€¼
	
2. æ‰“é–‹é …ç›®çš„ resources ç›®éŒ„ä¸‹çš„ application.properties é…ç½®æ–‡ä»¶ï¼Œåœ¨è©²é…ç½®æ–‡ä»¶ä¸­ç·¨å¯«éœ€è¦å° Person é¡è¨­ç½®çš„é…ç½®å±¬æ€§
	
	![[Study_Matthew/SpringBoot/_annex/Pasted image 20211105133627.png]]
	
	ç·¨å¯« application.properties é…ç½®æ–‡ä»¶æ™‚ï¼Œç”±æ–¼è¦é…ç½®çš„ Person å°è±¡å±¬æ€§æ˜¯æˆ‘å€‘è‡ªå®šç¾©çš„ï¼ŒSpringBoot ç„¡æ³•è‡ªå‹•è­˜åˆ¥ï¼Œæ‰€ä»¥ä¸æœƒæœ‰ä»»ä½•æ›¸å¯«æç¤ºã€‚åœ¨å¯¦éš›é–‹ç™¼ä¸­ï¼Œç‚ºäº†å‡ºç¾ä»£ç¢¼æç¤ºçš„æ•ˆæœä¾†æ–¹ä¾¿é…ç½®ï¼Œåœ¨ä½¿ç”¨@ConfigurationProperties è¨»è§£é€²è¡Œé…ç½®æ–‡ä»¶å±¬æ€§å€¼æ³¨å…¥æ™‚ï¼Œå¯ä»¥åœ¨ pom.xml æ–‡ä»¶ä¸­æ·»åŠ ä¸€å€‹ Spring Boot æä¾›çš„é…ç½®è™•ç†å™¨ä¾è³´:
	```xml
	<dependency>
	<groupId>org.springframework.boot</groupId>
	<artifactId>spring-boot-configuration-processor</artifactId>
	<optional>true</optional>
	</dependency>
	```

	åœ¨ pom.xml ä¸­æ·»åŠ ä¸Šè¿°é…ç½®ä¾è³´å¾Œï¼Œé‚„éœ€è¦é‡æ–°é‹è¡Œé …ç›®å•Ÿå‹•é¡æˆ–è€…ä½¿ç”¨â€œCtrl+F9â€å¿«æ·éµï¼ˆå³ Build Projectï¼‰é‡æ§‹ç•¶å‰ Spring Boot é …ç›®æ–¹å¯ç”Ÿæ•ˆ

3. æŸ¥çœ‹ application.properties é…ç½®æ–‡ä»¶æ˜¯å¦æ­£ç¢ºï¼ŒåŒæ™‚æŸ¥çœ‹å±¬æ€§é…ç½®æ•ˆæœï¼Œæ‰“é–‹é€šé IDEA å·¥å…·å‰µå»ºçš„é …ç›®æ¸¬è©¦é¡ï¼Œåœ¨è©²æ¸¬è©¦é¡ä¸­å¼•å…¥ Person å¯¦é«”é¡ Beanï¼Œä¸¦é€²è¡Œè¼¸å‡ºæ¸¬è©¦
	
	```java
	@RunWith(SpringRunner.class) // æµ‹è¯•å¯åŠ¨å™¨ï¼Œå¹¶åŠ è½½ Spring Boot æµ‹è¯•æ³¨è§£
	@SpringBootTest // æ ‡è®°ä¸º Spring Boot å•å…ƒæµ‹è¯•ç±»ï¼Œå¹¶åŠ è½½é¡¹ç›®çš„ ApplicationContext ä¸Šä¸‹æ–‡ç¯å¢ƒ
	class SpringbootDemoApplicationTests {
	 // é…ç½®æµ‹è¯•
	 @Autowired
	 private Person person;
	 @Test
	 void configurationTest() {
	  System.out.println(person);
	 }
	}
	```

	æ‰“å°ç»“æœï¼š
	
	![[Study_Matthew/SpringBoot/_annex/Pasted image 20211105133906.png]]

	å¯ä»¥çœ‹å‡ºï¼Œæ¸¬è©¦æ–¹æ³• configurationTest()é‹è¡ŒæˆåŠŸï¼ŒåŒæ™‚æ­£ç¢ºæ‰“å°å‡ºäº† Person å¯¦é«”é¡å°è±¡ã€‚è‡³æ­¤ï¼Œèªªæ˜ application.properties é…ç½®æ–‡ä»¶å±¬æ€§é…ç½®æ­£ç¢ºï¼Œä¸¦é€šéç›¸é—œè¨»è§£è‡ªå‹•å®Œæˆäº†å±¬æ€§æ³¨å…¥ 
	
### 1.5.3 application.yaml é…ç½®æ–‡ä»¶
YAML æ–‡ä»¶æ ¼å¼æ˜¯ Spring Boot æ”¯æŒçš„ä¸€ç¨® JSON è¶…é›†æ–‡ä»¶æ ¼å¼ï¼Œä»¥æ•¸æ“šç‚ºä¸­å¿ƒï¼Œæ¯” propertiesã€xml ç­‰æ›´é©åˆåšé…ç½®æ–‡ä»¶
- YAML å’Œ xml ç›¸æ¯”ï¼Œå°‘äº†ä¸€äº›çµæ§‹åŒ–çš„ä»£ç¢¼ï¼Œä½¿æ•¸æ“šæ›´ç›´æ¥ï¼Œä¸€ç›®äº†ç„¶
- l ç›¸æ¯” properties æ–‡ä»¶æ›´ç°¡æ½”
- YAML æ–‡ä»¶çš„æ“´å±•åå¯ä»¥ä½¿ç”¨.yml æˆ–è€….yamlã€‚
- application.yml æ–‡ä»¶ä½¿ç”¨ â€œkey:ï¼ˆç©ºæ ¼ï¼‰valueâ€æ ¼å¼é…ç½®å±¬æ€§ï¼Œä½¿ç”¨ç¸®é€²æ§åˆ¶å±¤ç´šé—œä¿‚ã€‚

é€™è£¡ï¼Œé‡å°ä¸åŒæ•¸æ“šé¡å‹çš„å±¬æ€§å€¼ï¼Œä»‹ç´¹ä¸€ä¸‹ YAML

1. value å€¼ç‚ºæ™®é€šæ•¸æ“šé¡å‹ï¼ˆä¾‹å¦‚æ•¸å­—ã€å­—ç¬¦ä¸²ã€å¸ƒçˆ¾ç­‰ï¼‰ 
	
	ç•¶ YAML é…ç½®æ–‡ä»¶ä¸­é…ç½®çš„å±¬æ€§å€¼ç‚ºæ™®é€šæ•¸æ“šé¡å‹æ™‚ï¼Œå¯ä»¥ç›´æ¥é…ç½®å°æ‡‰çš„å±¬æ€§å€¼ï¼ŒåŒæ™‚å°æ–¼å­—ç¬¦ä¸²é¡å‹çš„å±¬æ€§å€¼ï¼Œä¸éœ€è¦é¡å¤–æ·»åŠ å¼•è™Ÿï¼Œç¤ºä¾‹ä»£ç¢¼å¦‚ä¸‹
	
	```yaml
	server:
	  port: 8080
	  servlet:
	    context-path: /hello
	```

2. value å€¼ç‚ºæ•¸çµ„å’Œå–®åˆ—é›†åˆ

	ç•¶ YAML é…ç½®æ–‡ä»¶ä¸­é…ç½®çš„å±¬æ€§å€¼ç‚ºæ•¸çµ„æˆ–å–®åˆ—é›†åˆé¡å‹æ™‚ï¼Œä¸»è¦æœ‰å…©ç¨®æ›¸å¯«æ–¹å¼ï¼šç¸®é€²å¼å¯«æ³•å’Œè¡Œå…§å¼å¯«æ³•ã€‚
	
	å…¶ä¸­ï¼Œç¸®é€²å¼å¯«æ³•é‚„æœ‰å…©ç¨®è¡¨ç¤ºå½¢å¼ï¼Œç¤ºä¾‹ä»£ç¢¼å¦‚ä¸‹
	```yaml
	person:
	  hobby:
	    - play
	    - read
	    - sleep
	```
	æˆ–è€…ä½¿ç”¨å¦‚ä¸‹ç¤ºä¾‹å½¢å¼
	```yaml
	person:
	  hobby:
	    play,
	    read,
	    sleep
	```
	ä¸Šè¿°ä»£ç¢¼ä¸­ï¼Œåœ¨ YAML é…ç½®æ–‡ä»¶ä¸­é€šéå…©ç¨®ç¸®é€²å¼å¯«æ³•å° person å°è±¡çš„å–®åˆ—é›†åˆï¼ˆæˆ–æ•¸çµ„ï¼‰é¡å‹çš„æ„›å¥½ hobby è³¦å€¼ç‚º playã€read å’Œ sleepã€‚å…¶ä¸­ä¸€ç¨®å½¢å¼ç‚ºâ€œ-ï¼ˆç©ºæ ¼ï¼‰å±¬æ€§å€¼â€ï¼Œå¦ä¸€ç¨®å½¢å¼ç‚ºå¤šå€‹å±¬æ€§å€¼ä¹‹å‰åŠ è‹±æ–‡é€—è™Ÿåˆ†éš”ï¼ˆæ³¨æ„ï¼Œæœ€å¾Œä¸€å€‹å±¬æ€§å€¼å¾Œä¸è¦åŠ é€—è™Ÿï¼‰ã€‚
	```yaml
	person:
	  hobby: [play,read,sleep]
	```
	é€šéä¸Šè¿°ç¤ºä¾‹å°æ¯”ç™¼ç¾ï¼ŒYAML é…ç½®æ–‡ä»¶çš„è¡Œå…§å¼å¯«æ³•æ›´åŠ ç°¡æ˜ã€æ–¹ä¾¿ã€‚å¦å¤–ï¼ŒåŒ…å«å±¬æ€§å€¼çš„ä¸­æ‹¬è™Ÿâ€œ[]â€é‚„å¯ä»¥é€²ä¸€æ­¥çœç•¥ï¼Œåœ¨é€²è¡Œå±¬æ€§è³¦å€¼æ™‚ï¼Œç¨‹åºæœƒè‡ªå‹•åŒ¹é…å’Œæ ¡å° 
	
3. value å€¼ç‚º Map é›†åˆå’Œå°è±¡
	
	ç•¶ YAML é…ç½®æ–‡ä»¶ä¸­é…ç½®çš„å±¬æ€§å€¼ç‚º Map é›†åˆæˆ–å°åƒé¡å‹æ™‚ï¼ŒYAML é…ç½®æ–‡ä»¶æ ¼å¼åŒæ¨£å¯ä»¥åˆ†ç‚ºå…©ç¨®æ›¸å¯«æ–¹å¼ï¼šç¸®é€²å¼å¯«æ³•å’Œè¡Œå…§å¼å¯«æ³•ã€‚
	
	å…¶ä¸­ï¼Œç¸®é€²å¼å¯«æ³•çš„ç¤ºä¾‹ä»£ç¢¼å¦‚ä¸‹
	```yaml
	person: 
	  map: 
	    k1: v1 
	    k2: v2
	```
	å°æ‡‰çš„è¡Œå…§å¼å¯«æ³•ç¤ºä¾‹ä»£ç¢¼å¦‚ä¸‹
	```yaml
	person: 
	  map: {k1: v1,k2: v2}
	```

	åœ¨ YAML é…ç½®æ–‡ä»¶ä¸­ï¼Œé…ç½®çš„å±¬æ€§å€¼ç‚º Map é›†åˆæˆ–å°åƒé¡å‹æ™‚ï¼Œç¸®é€²å¼å¯«æ³•çš„å½¢å¼æŒ‰ç…§ YAML æ–‡ä»¶æ ¼å¼ç·¨å¯«å³å¯ï¼Œè€Œè¡Œå…§å¼å¯«æ³•çš„å±¬æ€§å€¼è¦ç”¨å¤§æ‹¬è™Ÿâ€œ{}â€åŒ…å«ã€‚
	
æ¥ä¸‹ä¾†ï¼Œåœ¨ Properties é…ç½®æ–‡ä»¶æ¼”ç¤ºæ¡ˆä¾‹åŸºç¤ä¸Šï¼Œé€šéé…ç½® application.yaml é…ç½®æ–‡ä»¶å° Person å°è±¡é€²è¡Œè³¦å€¼ï¼Œå…·é«”ä½¿ç”¨å¦‚ä¸‹ 

1. åœ¨é …ç›®çš„ resources ç›®éŒ„ä¸‹ï¼Œæ–°å»ºä¸€å€‹ application.yaml é…ç½®æ–‡ä»¶ï¼Œåœ¨è©²é…ç½®æ–‡ä»¶ä¸­ç·¨å¯«ç‚º Person é¡è¨­ç½®çš„é…ç½®å±¬æ€§
	
	```yaml
	#å°å¯¦é«”é¡å°è±¡ Person é€²è¡Œå±¬æ€§é…ç½®
	person:
	  id: 1
	  name: lucy
	  hobby: [åƒé£¯ï¼Œç¡è¦ºï¼Œæ‰“è±†è±†]
	  family: [father,mother]
	  map: {k1: v1,k2: v2}
	  pet: {type: dog,name: æ—ºè²¡}
	```
	
2. å†æ¬¡é€²è¡Œæ¸¬è©¦
	
	![[Study_Matthew/SpringBoot/_annex/Pasted image 20211105134959.png]]
	
	å¯ä»¥çœ‹å‡ºï¼Œæ¸¬è©¦æ–¹æ³• configurationTest()åŒæ¨£é‹è¡ŒæˆåŠŸï¼Œä¸¦æ­£ç¢ºæ‰“å°å‡ºäº† Person å¯¦é«”é¡å°è±¡ã€‚


## 1.6 å±¬æ€§æ³¨å…¥
ä½¿ç”¨ Spring Boot å…¨å±€é…ç½®æ–‡ä»¶è¨­ç½®å±¬æ€§æ™‚ï¼š

å¦‚æœé…ç½®å±¬æ€§æ˜¯ Spring Boot å·²æœ‰å±¬æ€§ï¼Œä¾‹å¦‚æœå‹™ç«¯å£ server.portï¼Œé‚£éº¼ Spring Boot å…§éƒ¨æœƒè‡ªå‹•æƒæä¸¦è®€å–é€™äº›é…ç½®æ–‡ä»¶ä¸­çš„å±¬æ€§å€¼ä¸¦è¦†è“‹é»˜èªå±¬æ€§ã€‚

å¦‚æœé…ç½®çš„å±¬æ€§æ˜¯ç”¨æˆ¶è‡ªå®šç¾©å±¬æ€§ï¼Œä¾‹å¦‚å‰›å‰›è‡ªå®šç¾©çš„ Person å¯¦é«”é¡å±¬æ€§ï¼Œé‚„å¿…é ˆåœ¨ç¨‹åºä¸­è¨»å…¥é€™äº›é…ç½®å±¬æ€§æ–¹å¯ç”Ÿæ•ˆã€‚

### 1.6.1 å±¬æ€§æ³¨å…¥å¸¸ç”¨è¨»è§£

@Configurationï¼šè²æ˜ä¸€å€‹é¡ä½œç‚ºé…ç½®é¡

@Beanï¼šè²æ˜åœ¨æ–¹æ³•ä¸Šï¼Œå°‡æ–¹æ³•çš„è¿”å›å€¼åŠ å…¥ Bean å®¹å™¨

@Valueï¼šå±¬æ€§æ³¨å…¥

@ConfigurationProperties(prefix = "jdbc")ï¼šæ‰¹é‡å±¬æ€§æ³¨å…¥

@PropertySource("classpath:/jdbc.properties")æŒ‡å®šå¤–éƒ¨å±¬æ€§æ–‡ä»¶ã€‚åœ¨é¡ä¸Šæ·»åŠ 

### 1.6.2 @Value å±¬æ€§å€¼æ³¨å…¥
1. å¼•å…¥æ•¸æ“šæºé€£æ¥ä¾è³´
	
	```xml
	<dependency>
	  <groupId>com.github.drtrang</groupId>
	  <artifactId>druid-spring-boot2-starter</artifactId>
	  <version>1.1.10</version>
	</dependency>
	```

2. application.properties æ·»åŠ ä¿¡æ¯
	
	```txt
	jdbc.driverClassName=com.mysql.jdbc.Driver
	jdbc.url=jdbc:mysql://127.0.0.1:3306/springboot_h
	jdbc.username=root
	jdbc.password=123
	```
	
3. é…ç½®æ•¸æ“šæº
	
	å‰µå»º JdbcConfiguration é¡ï¼š ä½¿ç”¨ spring ä¸­çš„ value è¨»è§£å°æ¯å€‹å±¬æ€§é€²è¡Œæ³¨å…¥,ç”¨ bean è¨»è§£å°‡è¿”å›å€¼æ·»åŠ åˆ°å®¹å™¨ä¸­
	```java
	@Configuration
	public class JdbcConfiguration {
		@Value("${jdbc.url}")
		String url;
		@Value("${jdbc.driverClassName}")
		String driverClassName;
		@Value("${jdbc.username}")
		String username;
		@Value("${jdbc.password}")
		String password;
		@Bean
		public DataSource dataSource() {
			DruidDataSource dataSource = new DruidDataSource();
			dataSource.setUrl(url);
			dataSource.setDriverClassName(driverClassName);
			dataSource.setUsername(username);
			dataSource.setPassword(password);
			return dataSource;
		}
	}
	```

### 1.6.3 @ConfigurationProperties æ‰¹é‡æ³¨å…¥
1. æ–°å»º JdbcProperties ï¼Œç”¨ä¾†é€²è¡Œå±¬æ€§æ³¨å…¥ï¼š
	
	```java
	@ConfigurationProperties(prefix = "jdbc") //è¿™é‡Œéœ€è¦å®šä¹‰å‡ºåœ¨ application æ–‡ä»¶ä¸­å®šä¹‰å±æ€§å€¼å¾—å‰ç¼€ä¿¡æ¯
	public class JdbcProperties {
		private String url;
		private String driverClassName;
		private String username;
		private String password;
		// æ³¨ï¼šè¦ç”Ÿæˆå±æ€§çš„ set æ–¹æ³•
	}
	```
	æ³¨ï¼šæ·»åŠ @ConfigurationProperties è¨»è§£å¾Œæœ‰è­¦å‘Šï¼šspringboot é…ç½®è¨»é‡‹è™•ç†å™¨æœªé…ç½®ï¼ˆç·¨å¯«é…ç½®æ–‡ä»¶æ­¤æ™‚ç„¡æç¤ºï¼‰

	![[Study_Matthew/SpringBoot/_annex/Pasted image 20211105135838.png]]

	æ·»åŠ  spring-boot-configuration-processor å¾Œå‡ºç¾æç¤ºï¼ŒåŠ å®Œä¾è³´å¾Œé€šé Ctrl+F9 ä¾†ä½¿ä¹‹ç”Ÿæ•ˆ
	```xml
	<dependency>
	 <groupId>org.springframework.boot</groupId>
	 <artifactId>spring-boot-configuration-processor</artifactId>
	 <optional>true</optional>
	</dependency>
	```

	æ¥è‘—ç™¼ç¾ï¼Œä»ç„¶æœ‰ç´…è‰²è­¦å‘Š

	![[Study_Matthew/SpringBoot/_annex/Pasted image 20211105135940.png]]

	@EnableConfigurationProperties æ˜¯ Spring Boot æä¾›çš„ä¸€å€‹è¨»è§£ï¼Œä½¿ç”¨è©²è¨»è§£ç”¨æ–¼å•Ÿç”¨æ‡‰ç”¨å°å¦å¤–ä¸€å€‹è¨»è§£ @ConfigurationProperties çš„æ”¯æŒï¼Œç”¨æ–¼è¨­ç½®ä¸€çµ„ä½¿ç”¨äº†è¨»è§£

	@ConfigurationProperties çš„é¡,ç”¨æ–¼ä½œç‚º bean å®šç¾©è¨»å†Šåˆ°å®¹å™¨ä¸­ã€‚

	![[Study_Matthew/SpringBoot/_annex/Pasted image 20211105140027.png]]

2. application.properties æ·»åŠ ä¿¡æ¯
	
	```txt
	jdbc.driverClassName=com.mysql.jdbc.Driver
	jdbc.url=jdbc:mysql://127.0.0.1:3306/springboot_h
	jdbc.username=root
	jdbc.password=123
	```
	æ³¨æ„ï¼šå°‡é…ç½®ä¿¡æ¯æ·»åŠ åˆ°é€™è£¡,é€šéå‰ç¶´é€²è¡Œå€åˆ†,é€²è¡Œå¼•ç”¨

3. æŸ¥çœ‹æ•ˆæœ
	
	```java
	@RunWith(SpringRunner.class)
	@SpringBootTest
	class Springbootlesson1ApplicationTests {
		@Autowired
		private JdbcProperties jdbcProperties;
		@Test
		public void jdbcPropertiesTest(){
		    System.out.println(jdbcProperties);
		}
	}
	```

	```log
	æ‰“å°ç»“æœï¼šJdbcProperties{url='jdbc:mysql://127.0.0.1:3306/springboot_h',
	driverClassName='com.mysql.jdbc.Driver', username='root', password='root'}
	```


### 1.6.4 ç¬¬ä¸‰æ–¹é…ç½®
é™¤äº† @ConfigurationProperties ç”¨æ–¼è¨»é‡‹é¡ä¹‹å¤–ï¼Œæ‚¨é‚„å¯ä»¥åœ¨å…¬å…± @Bean æ–¹æ³•ä¸Šä½¿ç”¨å®ƒã€‚ç•¶è¦å°‡å±¬æ€§ç¶å®šåˆ°æ§ä»¶ä¹‹å¤–çš„ç¬¬ä¸‰æ–¹çµ„ä»¶æ™‚ï¼Œé€™æ¨£åšç‰¹åˆ¥æœ‰ç”¨ã€‚

æ•ˆæœæ¼”ç¤º:

å‰µå»ºä¸€å€‹å…¶ä»–çµ„ä»¶é¡
```java
@Data
public class AnotherComponent {
	private boolean enabled;
	private InetAddress remoteAddress;
}

```

å‰µå»º MyService
```java
@Configuration
public class MyService {
	@ConfigurationProperties("another")
	@Bean
	public AnotherComponent anotherComponent(){
		return new AnotherComponent();
	}
}
```

é…ç½®æ–‡ä»¶
```txt
another.enabled=true
another.remoteAddress=192.168.10.11
```

æ¸¬è©¦é¡
```java
@Autowired
private AnotherComponent anotherComponent;
@Test
public void myServiceTest(){
	System.out.println(anotherComponent);
}
```
æˆ‘å€‘é€šéæ¸¬è©¦å¯ä»¥ç²å¾— AnotherComponent çµ„ä»¶çš„å¯¦ä¾‹å°è±¡ã€‚


### 1.6.5 é¬†æ•£ç¶å®š
Spring Boot ä½¿ç”¨ä¸€äº›å¯¬é¬†çš„è¦å‰‡å°‡ç’°å¢ƒå±¬æ€§ç¶å®šåˆ°@ConfigurationProperties beanï¼Œå› æ­¤ç’°å¢ƒå±¬æ€§åå’Œ bean å±¬æ€§åä¹‹é–“ä¸éœ€è¦å®Œå…¨åŒ¹é…

ä¾‹å¦‚å±¬æ€§é¡ï¼š

```java
@Data
@Component
@ConfigurationProperties("acme.my-person.person")
public class OwnerProperties {
	private String firstName;
}

```

```yaml
acme:
  my-person:
    person:
      first-name: æ³°æ£®
```

**å±¬æ€§æ–‡ä»¶ä¸­é…ç½®**|**èªªæ˜** 
--|--
acme.my-project.person.first-name | ç¾Šè‚‰ä¸²æ¨¡å¼ case, æ¨è–¦ä½¿ç”¨ 
acme.myProject.person.firstName | æ¨™æº–é§å³°æ¨¡å¼ 
acme.my_project.person.first_name | ä¸‹åŠƒç·šæ¨¡å¼ 
ACME_MYPROJECT_PERSON_FIRSTNAME | å¤§å¯«ä¸‹åŠƒç·šï¼Œå¦‚æœä½¿ç”¨ç³»çµ±ç’°å¢ƒæ™‚å€™æ¨è–¦ä½¿ç”¨

### 1.6.6 @ConfigurationProperties vs @Value

ç‰¹å¾µ |@ConfigurationProperties |@Value
--|--|--
[å¯¬é¬†çš„ç¶å®š](https://docs.spring.io/spring-boot/docs/2.4.0/reference/html/spring-boot-features.html#boot-features-external-config-relaxed-binding) |yes |Limitedï¼ˆè©³è¦‹ä¸‹æ–¹å®˜ç¶²æˆªåœ–ï¼‰
[å…ƒæ•¸æ“šæ”¯æŒ](https://docs.spring.io/spring-boot/docs/2.4.0/reference/html/appendix-configuration-metadata.html#configuration-metadata) |yes |no
SpEL è¡¨é”å¼ |no |yes
æ‡‰ç”¨å ´æ™¯ | æ‰¹é‡å±¬æ€§ç¶å®š | å–®å€‹å±¬æ€§ç¶å®š
![[Study_Matthew/SpringBoot/_annex/Pasted image 20211105141207.png]]


## 1.7 SpringBoot æ—¥èªŒæ¡†æ¶
### 1.7.1 æ—¥èªŒæ¡†æ¶ä»‹ç´¹
åœ¨é …ç›®çš„é–‹ç™¼ä¸­ï¼Œæ—¥èªŒæ˜¯å¿…ä¸å¯å°‘çš„ä¸€å€‹è¨˜éŒ„äº‹ä»¶çš„çµ„ä»¶ï¼Œä¸ç®¡æ˜¯è¨˜éŒ„é‹è¡Œæƒ…æ³é‚„æ˜¯è¿½è¸ªç·šä¸Šå•é¡Œï¼Œéƒ½é›¢ä¸é–‹å°æ—¥èªŒçš„åˆ†æï¼Œæ‰€ä»¥ä¹Ÿæœƒç›¸æ‡‰çš„åœ¨é …ç›®ä¸­å¯¦ç¾å’Œæ§‹å»ºæˆ‘å€‘æ‰€éœ€è¦çš„æ—¥èªŒæ¡†æ¶ã€‚

è€Œå¸‚é¢ä¸Šå¸¸è¦‹çš„æ—¥èªŒæ¡†æ¶æœ‰å¾ˆå¤šï¼Œæ¯”å¦‚ï¼šJCLã€SLF4Jã€Jboss-loggingã€jULã€log4jã€log4j2ã€logback ç­‰ç­‰ï¼Œæˆ‘å€‘è©²å¦‚ä½•é¸æ“‡å‘¢ï¼Ÿ

é€šå¸¸æƒ…æ³ä¸‹ï¼Œæ—¥èªŒæ˜¯ç”±ä¸€å€‹æŠ½è±¡å±¤ + å¯¦ç¾å±¤çš„çµ„åˆä¾†æ­å»ºçš„ã€‚

æ—¥èªŒ-æŠ½è±¡å±¤ | æ—¥èªŒ-å¯¦ç¾å±¤
--|--
JCLï¼ˆJakarta Commons Loggingï¼‰ã€SLF4Jï¼ˆSimple Logging Facade for Javaï¼‰ã€jboss-logging |julï¼ˆjava.util.loggingï¼‰ã€log4jã€logbackã€log4j2

### 1.7.2 SLF4J çš„ä½¿ç”¨ 
åœ¨å¼€å‘çš„æ—¶å€™ä¸åº”è¯¥ç›´æ¥ä½¿ç”¨æ—¥å¿—å®ç°ç±»ï¼Œåº”è¯¥ä½¿ç”¨æ—¥å¿—çš„æŠ½è±¡å±‚ã€‚å…·ä½“å‚è€ƒ [SLF4J](https://www.slf4j.org/manual.html) å®˜æ–¹ã€‚ 

SLF4J å®˜æ–¹ç»™å‡ºäº†ç®€å•ç¤ºä¾‹ã€‚ 

é¦–å…ˆè¦ä¸ºç³»ç»Ÿå¯¼å…¥ SLF4J çš„ jar .
```java
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
public class HelloWorld {
	public static void main(String[] args) {
	elloWorld.class);
	logger.info("Hello World");
	}
}
```

ä¸‹åœ–æ˜¯ SLF4J çµåˆå„ç¨®æ—¥èªŒæ¡†æ¶çš„å®˜æ–¹ç¤ºä¾‹ï¼Œå¾åœ–ä¸­å¯ä»¥æ¸…æ™°çš„çœ‹å‡º SLF4J API æ°¸é ä½œç‚ºæ—¥èªŒçš„é–€é¢ï¼Œç›´æ¥æ‡‰ç”¨èˆ‡æ‡‰ç”¨ç¨‹åºä¸­ã€‚

![[Study_Matthew/SpringBoot/_annex/Pasted image 20211105141557.png]]

æ³¨æ„:ç”±æ–¼æ¯ä¸€å€‹æ—¥èªŒçš„å¯¦ç¾æ¡†æ¶éƒ½æœ‰è‡ªå·±çš„é…ç½®æ–‡ä»¶ï¼Œæ‰€ä»¥åœ¨ä½¿ç”¨ SLF4j ä¹‹å¾Œï¼Œé…ç½®æ–‡ä»¶é‚„æ˜¯è¦ä½¿ç”¨å¯¦
ç¾æ—¥èªŒæ¡†æ¶çš„é…ç½®æ–‡ä»¶ã€‚


### 1.7.3. çµ±ä¸€æ—¥èªŒæ¡†æ¶çš„ä½¿ç”¨
éºç•™å•é¡Œï¼šA é …ç›®ï¼ˆslf4J + logbackï¼‰: Springï¼ˆcommons loggingï¼‰ã€Hibernateï¼ˆjboss-loggingï¼‰ã€mybatis....

ä¸€èˆ¬æƒ…æ³ä¸‹ï¼Œåœ¨é …ç›®ä¸­å­˜åœ¨è‘—å„ç¨®ä¸åŒçš„ç¬¬ä¸‰æ–¹ jar ï¼Œä¸”å®ƒå€‘çš„æ—¥èªŒé¸æ“‡ä¹Ÿå¯èƒ½ä¸ç›¡ç›¸åŒï¼Œé¡¯ç„¶é€™æ¨£æ˜¯ä¸åˆ©æ–¼æˆ‘å€‘ä½¿ç”¨çš„ï¼Œé‚£éº¼å¦‚æœæˆ‘å€‘æƒ³ç‚ºé …ç›®è¨­ç½®çµ±ä¸€çš„æ—¥èªŒæ¡†æ¶è©²æ€éº¼è¾¦å‘¢ï¼Ÿ

åœ¨ [SLF4J](https://www.slf4j.org/legacy.html) å®˜æ–¹ï¼Œä¹Ÿçµ¦äº†æˆ‘å€‘åƒè€ƒçš„ä¾‹å­

![[Study_Matthew/SpringBoot/_annex/Pasted image 20211105141817.png]]

å¾åœ–ä¸­æˆ‘å€‘å¾—åˆ°ä¸€ç¨®çµ±ä¸€æ—¥èªŒæ¡†æ¶ä½¿ç”¨çš„æ–¹å¼ï¼Œå¯ä»¥ä½¿ç”¨ä¸€ç¨®å’Œè¦æ›¿æ›çš„æ—¥èªŒæ¡†æ¶é¡å®Œå…¨ä¸€æ¨£çš„ jar é€²è¡Œæ›¿æ›ï¼Œé€™æ¨£ä¸è‡³æ–¼åŸä¾†çš„ç¬¬ä¸‰æ–¹ jar å ±éŒ¯ï¼Œè€Œé€™å€‹æ›¿æ›çš„ jar å…¶å¯¦ä½¿ç”¨äº† SLF4J API. é€™æ¨£é …ç›®ä¸­çš„æ—¥å¿—å°±éƒ½å¯ä»¥é€šé SLF4J API çµåˆè‡ªå·±é¸æ“‡çš„æ¡†æ¶é€²è¡Œæ—¥èªŒè¼¸å‡ºã€‚

çµ±ä¸€æ—¥èªŒæ¡†æ¶ä½¿ç”¨æ­¥é©Ÿæ­¸ç´å¦‚ä¸‹ï¼š
1. æ’é™¤ç³»çµ±ä¸­çš„å…¶ä»–æ—¥èªŒæ¡†æ¶ã€‚
2. ä½¿ç”¨ä¸­é–“åŒ…æ›¿æ›è¦æ›¿æ›çš„æ—¥èªŒæ¡†æ¶ã€‚
3. å°å…¥æˆ‘å€‘é¸æ“‡çš„ SLF4J å¯¦ç¾ã€‚


### 1.7.4. Spring Boot çš„æ—¥èªŒé—œä¿‚
1. æ’é™¤å…¶ä»–æ—¥èªŒæ¡†æ¶
	
	æ ¹æ“šä¸Šé¢ç¸½çµçš„è¦çµ±ä¸€æ—¥èªŒæ¡†æ¶çš„ä½¿ç”¨ï¼Œç¬¬ä¸€æ­¥è¦æ’é™¤å…¶ä»–çš„æ—¥èªŒæ¡†æ¶ï¼Œåœ¨ Spring Boot çš„ Maven ä¾è³´è£¡å¯ä»¥æ¸…æ¥šçš„çœ‹åˆ° Spring Boot æ’é™¤äº†å…¶ä»–æ—¥èªŒæ¡†æ¶ã€‚
	
	![[Study_Matthew/SpringBoot/_annex/Pasted image 20211105141939.png]]
	
	æˆ‘å€‘è‡ªè¡Œæ’é™¤ä¾è³´æ™‚ä¹Ÿåªéœ€è¦æŒ‰ç…§åœ–ä¸­çš„æ–¹å¼å°±å¥½äº†ã€‚
	
2. çµ±ä¸€æ¡†æ¶å¼•å…¥æ›¿æ›åŒ…
	
	Spring Boot æ˜¯ä½¿ç”¨äº† SLF4J+logback çš„æ—¥èªŒæ¡†æ¶çµ„åˆï¼ŒæŸ¥çœ‹ Spring Boot é …ç›®çš„ Maven ä¾è³´é—œä¿‚å¯ä»¥çœ‹åˆ° Spring Boot çš„æ ¸å¿ƒå•Ÿå‹•å™¨ spring-boot-starter å¼•å…¥äº† spring-boot-starter-logging.
	```xml
	<dependency>
	 <groupId>org.springframework.boot</groupId>
	 <artifactId>spring-boot-starter-logging</artifactId>
	 <version>2.4.0.RELEASE</version>
	</dependency>
	```
	
	è€Œ spring-boot-starter-logging çš„ Maven ä¾è³´ä¸»è¦å¼•å…¥äº† logback-classic (åŒ…å«äº†æ—¥èªŒæ¡†æ¶ Logback çš„å¯¦ç¾)ï¼Œlog4j-to-slf4j (åœ¨ log4j æ—¥èªŒæ¡†æ¶ä½œè€…é–‹ç™¼æ­¤æ¡†æ¶çš„æ™‚å€™é‚„æ²’æœ‰æƒ³åˆ°ä½¿ç”¨æ—¥èªŒæŠ½è±¡å±¤é€²è¡Œé–‹ç™¼ï¼Œå› æ­¤å‡ºç¾äº† log4j å‘ slf4j è½‰æ›çš„å·¥å…·)ï¼Œjul-to-slf4j ( Java è‡ªå¸¶çš„æ—¥èªŒæ¡†æ¶è½‰æ›ç‚º slf4j).
	```xml
	<dependencies>
		<dependency>
			<groupId>ch.qos.logback</groupId>
			<artifactId>logback-classic</artifactId>
			<version>1.2.3</version>
			<scope>compile</scope>
		</dependency>
		<dependency>
			<groupId>org.apache.logging.log4j</groupId>
			<artifactId>log4j-to-slf4j</artifactId>
			<version>2.13.3</version>
			<scope>compile</scope>
		</dependency>
		<dependency>
			<groupId>org.slf4j</groupId>
			<artifactId>jul-to-slf4j</artifactId>
			<version>1.7.30</version>
			<scope>compile</scope>
		</dependency>
	</dependencies>
	```
	
	å¾ä¸Šé¢çš„åˆ†æï¼ŒSpring Boot å°æ—¥èªŒæ¡†æ¶çš„ä½¿ç”¨å·²ç¶“æ˜¯æ¸…æ™°æ˜äº†äº†ï¼Œæˆ‘å€‘ä½¿ç”¨ IDEA å·¥å…·æŸ¥çœ‹ Maven ä¾è³´é—œä¿‚ï¼Œå¯ä»¥æ¸…æ™°çš„çœ‹åˆ°æ—¥èªŒæ¡†æ¶çš„å¼•ç”¨ç”±æ­¤å¯è¦‹ï¼ŒSpring Boot å¯ä»¥è‡ªå‹•çš„é©é…æ—¥èªŒæ¡†æ¶ï¼Œè€Œä¸”åº•å±¤ä½¿ç”¨ SLF4j + LogBack è¨˜éŒ„æ—¥èªŒï¼Œå¦‚æœæˆ‘å€‘è‡ªè¡Œå¼•å…¥å…¶ä»–æ¡†æ¶ï¼Œéœ€è¦æ’é™¤å…¶æ—¥èªŒæ¡†æ¶ã€‚
	
	![[Study_Matthew/SpringBoot/_annex/Pasted image 20211105142312.png]]

### 1.7.5. Spring Boot çš„æ—¥èªŒä½¿ç”¨

**æ—¥èªŒç´šåˆ¥å’Œæ ¼å¼**

å¾ä¸Šé¢çš„åˆ†æï¼Œç™¼ç¾ Spring Boot é»˜èªå·²ç¶“ä½¿ç”¨äº† SLF4J + LogBack . æ‰€ä»¥æˆ‘å€‘åœ¨ä¸é€²è¡Œä»»ä½•é¡å¤–æ“ä½œçš„æƒ…æ³ä¸‹å°±å¯ä»¥ä½¿ç”¨ SLF4J + Logback é€²è¡Œæ—¥èªŒè¼¸å‡ºã€‚

ç·¨å¯« Java æ¸¬è©¦é¡é€²è¡Œæ¸¬è©¦ã€‚
```java
import org.junit.Test;
import org.junit.runner.RunWith;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.test.context.junit4.SpringRunner;
/**
* æµ‹è¯•æ—¥å¿—è¾“å‡ºï¼Œ
* SLF4J æ—¥å¿—çº§åˆ«ä»å°åˆ°å¤§ trace,debug,info,warn,error
*
*/
@RunWith(SpringRunner.class)
@SpringBootTest
public class LogbackTest {
	Logger logger = LoggerFactory.getLogger(getClass());
	@Test
	public void testLog() {
		logger.trace("Trace æ—¥å¿—...");
		logger.debug("Debug æ—¥å¿—...");
		logger.info("Info æ—¥å¿—...");
		logger.warn("Warn æ—¥å¿—...");
		logger.error("Error æ—¥å¿—...");
	}
}
```

å·²çŸ¥æ—¥èªŒç´šåˆ¥å¾å°åˆ°å¤§ç‚º trace < debug < info < warn < error . é‹è¡Œå¾—åˆ°è¼¸å‡ºå¦‚ä¸‹ã€‚ç”±æ­¤å¯è¦‹ **SpringBoot é»˜èªæ—¥èªŒç´šåˆ¥ç‚º INFO.**
```log
2020-11-16 19:58:43.094 INFO 39940 --- [ main]
com.lagou.Springboot01DemoApplicationTests : Info æ—¥å¿—...
2020-11-16 19:58:43.094 WARN 39940 --- [ main]
com.lagou.Springboot01DemoApplicationTests : Warn æ—¥å¿—...
2020-11-16 19:58:43.094 ERROR 39940 --- [ main]
com.lagou.Springboot01DemoApplicationTests : Error æ—¥å¿—...
```

å¾ä¸Šé¢çš„æ—¥èªŒçµåˆ Logback æ—¥èªŒæ ¼å¼å¯ä»¥çŸ¥é“ Spring Boot é»˜èªæ—¥èªŒæ ¼å¼æ˜¯
```log
%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{50} - %msg%n
# %d{yyyy-MM-dd HH:mm:ss.SSS} æ—¶é—´
# %thread çº¿ç¨‹åç§°
# %-5level æ—¥å¿—çº§åˆ«ä»å·¦æ˜¾ç¤º 5 ä¸ªå­—ç¬¦å®½åº¦
# %logger{50} ç±»å
# %msg%n æ—¥å¿—ä¿¡æ¯åŠ æ¢è¡Œ
```

è‡³æ–¼ç‚ºä»€éº¼ Spring Boot çš„é»˜èªæ—¥èªŒè¼¸å‡ºæ ¼å¼æ˜¯é€™æ¨£ï¼Ÿ

![[Study_Matthew/SpringBoot/_annex/Pasted image 20211105142556.png]]

æˆ‘å€‘å¯ä»¥åœ¨ Spring Boot çš„æºç¢¼è£¡æ‰¾åˆ°ç­”æ¡ˆã€‚



### 1.7.6 è‡ªå®šç¾©æ—¥èªŒè¼¸å‡º
å¯ä»¥ç›´æ¥åœ¨é…ç½®æ–‡ä»¶ç·¨å¯«æ—¥èªŒç›¸é—œé…ç½®
```log
# æ—¥å¿—é…ç½®
# æŒ‡å®šå…·ä½“åŒ…çš„æ—¥å¿—çº§åˆ«
logging.level.com.lagou=debug
# æ§åˆ¶å°å’Œæ—¥å¿—æ–‡ä»¶è¾“å‡ºæ ¼å¼
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level
%logger{50} - %msg%n
logging.pattern.file=%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{50}
- %msg%n
# æ—¥å¿—è¾“å‡ºè·¯å¾„ï¼Œé»˜è®¤æ–‡ä»¶ spring.log
logging.file.path=spring.log
#logging.file.name=log.log
```

é—œæ–¼æ—¥èªŒçš„è¼¸å‡ºè·¯å¾‘ï¼Œå¯ä»¥ä½¿ç”¨ logging.file æˆ–è€… logging.path é€²è¡Œå®šç¾©ï¼Œå…©è€…å­˜åœ¨é—œä¿‚å¦‚ä¸‹è¡¨ã€‚


logging.file |logging.path | ä¾‹å­ | æè¿°
--|--|--|--
ï¼ˆæ²’æœ‰ï¼‰ |ï¼ˆæ²’æœ‰ï¼‰ | | åƒ…æ§åˆ¶å°è¨˜éŒ„ã€‚
å…·é«”æ–‡ä»¶ |ï¼ˆæ²’æœ‰ï¼‰ |my.log | å¯«å…¥æŒ‡å®šçš„æ—¥èªŒæ–‡ä»¶ï¼Œåç¨±å¯ä»¥æ˜¯ç²¾ç¢ºä½ç½®æˆ–ç›¸å°æ–¼ç•¶å‰ç›®éŒ„ã€‚
ï¼ˆæ²’æœ‰ï¼‰ | å…·é«”ç›®éŒ„ |/var/log | å¯«å…¥ spring.log æŒ‡å®šçš„ç›®éŒ„ï¼Œåç¨±å¯ä»¥æ˜¯ç²¾ç¢ºä½ç½®æˆ–ç›¸å°æ–¼ç•¶å‰ç›®éŒ„ã€‚


### 1.7.7 æ›¿æ›æ—¥èªŒæ¡†æ¶
å› ç‚º Log4j æ—¥èªŒæ¡†æ¶å·²ç¶“å¹´ä¹…å¤±ä¿®ï¼ŒåŸä½œè€…éƒ½è¦ºå¾—å¯«çš„ä¸å¥½ï¼Œæ‰€ä»¥ä¸‹é¢æ¼”ç¤ºæ›¿æ›æ—¥èªŒæ¡†æ¶ç‚º Log4j2 çš„æ–¹å¼ã€‚æ ¹æ“š[å®˜ç¶²](https://docs.spring.io/spring-boot/docs/current/reference/html/using-spring-boot.html#using-boot)æˆ‘å€‘ Log4j2 èˆ‡ logging éœ€è¦äºŒé¸ä¸€ï¼Œå› æ­¤ä¿®æ”¹ pom å¦‚ä¸‹
```xml
<dependency>
	<groupId>org.springframework.boot</groupId>
	<artifactId>spring-boot-starter-web</artifactId>
	<exclusions>
		<exclusion>
			<artifactId>spring-boot-starter-logging</artifactId>
			<groupId>org.springframework.boot</groupId>
		</exclusion>
	</exclusions>
</dependency>
<dependency>
	<groupId>org.springframework.boot</groupId>
	<artifactId>spring-boot-starter-log4j2</artifactId>
</dependency>
```


























