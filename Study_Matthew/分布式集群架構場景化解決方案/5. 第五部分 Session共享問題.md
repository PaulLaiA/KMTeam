---
date: 2021-12-09
aliases: []
---

# Metadata

**Title** :: MyBatis

**Author** :: #Matthew 

**Classification** :: #Learn #Java #Basic #MyBatis

**Status** :: #ğŸŒ±

**Type** :: #Note

**Previous** ::[[Study_Matthew/åˆ†å¸ƒå¼é›†ç¾¤æ¶æ§‹å ´æ™¯åŒ–è§£æ±ºæ–¹æ¡ˆ/4. ç¬¬å››éƒ¨åˆ† åˆ†ä½ˆå¼èª¿åº¦å•é¡Œ]]

**ParentNode** :: [[Study_Matthew/åˆ†å¸ƒå¼é›†ç¾¤æ¶æ§‹å ´æ™¯åŒ–è§£æ±ºæ–¹æ¡ˆ/åˆ†å¸ƒå¼é›†ç¾¤æ¶æ§‹å ´æ™¯åŒ–è§£æ±ºæ–¹æ¡ˆ]]

---


# ç¬¬äº”éƒ¨åˆ†ï¼šSessionå…±äº«å•é¡Œ

Sessionå…±äº«åŠSessionä¿æŒæˆ–è€…å«åšSessionâ¼€è‡´æ€§

![[Study_Matthew/åˆ†å¸ƒå¼é›†ç¾¤æ¶æ§‹å ´æ™¯åŒ–è§£æ±ºæ–¹æ¡ˆ/_annex/Pasted image 20211209173940.png]]

## ç¬¬ 1 ç¯€ Sessionå•é¡ŒåŸå› åˆ†æ

å‡ºç¾é€™å€‹å•é¡Œçš„åŸå› ï¼Œå¾æ ¹æœ¬ä¸Šä¾†èªªæ˜¯å› ç‚ºHttpå”è­°æ˜¯â½†ç‹€æ…‹çš„å”è­°ã€‚å®¢æˆ¶ç«¯å’Œæœå‹™ç«¯åœ¨æŸæ¬¡æœƒè©±ä¸­ç”¢â½£çš„æ•¸æ“šä¸æœƒè¢«ä¿ç•™ä¸‹ä¾†ï¼Œæ‰€ä»¥ç¬¬â¼†æ¬¡è«‹æ±‚æœå‹™ç«¯â½†æ³•èªè­˜åˆ°ä½ æ›¾ç¶“ä¾†éï¼Œ Httpç‚ºä»€éº¼è¦è¨­è¨ˆç‚ºâ½†ç‹€æ…‹å”è­°ï¼Ÿæ—©æœŸéƒ½æ˜¯éœæ…‹â»šâ¾¯â½†æ‰€è¬‚æœ‰â½†ç‹€æ…‹ï¼Œå¾Œä¾†æœ‰å‹•æ…‹çš„å…§å®¹æ›´è±å¯Œï¼Œå°±éœ€è¦æœ‰ç‹€æ…‹ï¼Œå‡ºç¾äº†å…©ç¨®â½¤æ–¼ä¿æŒHttpç‹€æ…‹çš„æŠ€è¡“ï¼Œé‚£å°±æ˜¯Cookieå’ŒSessionã€‚ â½½å‡ºç¾ä¸Šè¿°ä¸åœè®“ç™»éŒ„çš„å•é¡Œï¼Œåˆ†æå¦‚ä¸‹åœ–ï¼š

å ´æ™¯ï¼šnginxé»˜èªè¼ªè©¢ç­–ç•¥

![[Study_Matthew/åˆ†å¸ƒå¼é›†ç¾¤æ¶æ§‹å ´æ™¯åŒ–è§£æ±ºæ–¹æ¡ˆ/_annex/Pasted image 20211209174028.png]]


## ç¬¬ 2 ç¯€ è§£æ±ºSessionâ¼€è‡´æ€§çš„â½…æ¡ˆ

- Nginxçš„ IP_Hash ç­–ç•¥ï¼ˆå¯ä»¥ä½¿â½¤ï¼‰
	
	åŒâ¼€å€‹å®¢æˆ¶ç«¯IPçš„è«‹æ±‚éƒ½æœƒè¢«è·¯ç”±åˆ°åŒâ¼€å€‹â½¬æ¨™æœå‹™å™¨ï¼Œä¹Ÿå«åšæœƒè©±ç²˜æ»¯
	
	å„ªé»ï¼š
	- é…ç½®ç°¡å–®ï¼Œä¸â¼Šä¾µæ‡‰â½¤ï¼Œä¸éœ€è¦é¡å¤–ä¿®æ”¹ä»£ç¢¼

	ç¼ºé»ï¼š
	- æœå‹™å™¨é‡å•ŸSessionä¸Ÿå¤±
	- å­˜åœ¨å–®é»è² è¼‰â¾¼çš„â»›éšª
	- å–®é»æ•…éšœå•é¡Œ

- Sessionè¤‡è£½ï¼ˆä¸æ¨è–¦ï¼‰

	ä¹Ÿå³ï¼Œå¤šå€‹tomcatä¹‹é–“é€šéä¿®æ”¹é…ç½®â½‚ä»¶ï¼Œé”åˆ°Sessionä¹‹é–“çš„è¤‡åˆ¶

	![[Study_Matthew/åˆ†å¸ƒå¼é›†ç¾¤æ¶æ§‹å ´æ™¯åŒ–è§£æ±ºæ–¹æ¡ˆ/_annex/Pasted image 20211209174154.png]]


	å„ªé»ï¼š
	- ä¸â¼Šä¾µæ‡‰â½¤
	- ä¾¿æ–¼æœå‹™å™¨â½”å¹³æ“´å±•
	- èƒ½é©æ‡‰å„ç¨®è² è¼‰å‡è¡¡ç­–ç•¥
	- æœå‹™å™¨é‡å•Ÿæˆ–è€…å®•æ©Ÿä¸æœƒé€ æˆSessionä¸Ÿå¤±

	ç¼ºé»ï¼š
	- æ€§èƒ½ä½
	- å…§å­˜æ¶ˆè€—
	- ä¸èƒ½å­˜å„²å¤ªå¤šæ•¸æ“šï¼Œå¦å‰‡æ•¸æ“šè¶Šå¤šè¶Šå½±éŸ¿æ€§èƒ½
	- å»¶é²æ€§

- Sessionå…±äº«ï¼ŒSessioné›†ä¸­å­˜å„²ï¼ˆæ¨è–¦ï¼‰

	Sessionçš„æœ¬è³ªå°±æ˜¯ç·©å­˜ï¼Œé‚£Sessionæ•¸æ“šç‚ºä»€éº¼ä¸äº¤çµ¦å°ˆæ¥­çš„ç·©å­˜ä¸­é–“ä»¶å‘¢ï¼Ÿ â½å¦‚Redis

	![[Study_Matthew/åˆ†å¸ƒå¼é›†ç¾¤æ¶æ§‹å ´æ™¯åŒ–è§£æ±ºæ–¹æ¡ˆ/_annex/Pasted image 20211209174314.png]]
	
	å„ªé»:
	- èƒ½é©æ‡‰å„ç¨®è² è¼‰å‡è¡¡ç­–ç•¥
	- æœå‹™å™¨é‡å•Ÿæˆ–è€…å®•æ©Ÿä¸æœƒé€ æˆSessionä¸Ÿå¤±
	- æ“´å±•èƒ½â¼’å¼·
	- é©åˆâ¼¤é›†ç¾¤æ•¸é‡ä½¿â½¤
	
	ç¼ºé»ï¼š
	- å°æ‡‰â½¤æœ‰â¼Šä¾µï¼Œå¼•â¼Šäº†å’ŒRedisçš„äº¤äº’ä»£ç¢¼

	**Spring Sessionä½¿å¾—åŸºæ–¼Redisçš„Sessionå…±äº«æ‡‰â½¤èµ·ä¾†â¾®å¸¸ä¹‹ç°¡å–®**

	1ï¼‰å¼•â¼ŠJar
	```xml
	<dependency>
	 <groupId>org.springframework.boot</groupId>
	 <artifactId>spring-boot-starter-data-redis</artifactId>
	</dependency>
	<dependency>
	 <groupId>org.springframework.session</groupId>
	 <artifactId>spring-session-data-redis</artifactId>
	</dependency>
	```

	2ï¼‰é…ç½®redis
	```txt
	spring.redis.database=0
	spring.redis.host=127.0.0.1
	spring.redis.port=6379
	```
	
	3ï¼‰æ·»åŠ è¨»è§£
	
	![[Study_Matthew/åˆ†å¸ƒå¼é›†ç¾¤æ¶æ§‹å ´æ™¯åŒ–è§£æ±ºæ–¹æ¡ˆ/_annex/Pasted image 20211209174627.png]]
	
	**æºç ç¤ºæ„ï¼ˆäº†è§£ï¼‰**
	
	![[Study_Matthew/åˆ†å¸ƒå¼é›†ç¾¤æ¶æ§‹å ´æ™¯åŒ–è§£æ±ºæ–¹æ¡ˆ/_annex/Pasted image 20211209174647.png]]
	
	è©²è¨»è§£å¯ä»¥å‰µå»ºâ¼€å€‹éæ¿¾å™¨ä½¿å¾—SpringSessionæ›¿ä»£HttpSessionç™¼æ®ä½œâ½¤ï¼Œæ‰¾åˆ°é‚£å€‹éæ¿¾å™¨ï¼
	
	![[Study_Matthew/åˆ†å¸ƒå¼é›†ç¾¤æ¶æ§‹å ´æ™¯åŒ–è§£æ±ºæ–¹æ¡ˆ/_annex/Pasted image 20211209174707.png]]
	
	è§€å¯Ÿå…¶â½—é¡ï¼Œâ½—é¡ä¸­æœ‰Filter

	![[Study_Matthew/åˆ†å¸ƒå¼é›†ç¾¤æ¶æ§‹å ´æ™¯åŒ–è§£æ±ºæ–¹æ¡ˆ/_annex/Pasted image 20211209174735.png]]

	é€™å€‹Filterå°±æ˜¯SpringSessionæœ€æ ¸â¼¼çš„åœ°â½…

	![[Study_Matthew/åˆ†å¸ƒå¼é›†ç¾¤æ¶æ§‹å ´æ™¯åŒ–è§£æ±ºæ–¹æ¡ˆ/_annex/Pasted image 20211209174757.png]]

	åœ¨éæ¿¾å™¨ä¸­å°‡HttpServletRequeståŒ…è£

	![[Study_Matthew/åˆ†å¸ƒå¼é›†ç¾¤æ¶æ§‹å ´æ™¯åŒ–è§£æ±ºæ–¹æ¡ˆ/_annex/Pasted image 20211209174813.png]]

	æœ¬è³ªå°±æ˜¯â¼€å€‹HtppRequestï¼Œæ“æœ‰åŒæ¨£çš„â½…æ³•ï¼Œæ‰¾getSession

	![[Study_Matthew/åˆ†å¸ƒå¼é›†ç¾¤æ¶æ§‹å ´æ™¯åŒ–è§£æ±ºæ–¹æ¡ˆ/_annex/Pasted image 20211209174835.png]]

	å›åˆ°SessionRepositoryFilterçš„doFilterInternalâ½…æ³•

	![[Study_Matthew/åˆ†å¸ƒå¼é›†ç¾¤æ¶æ§‹å ´æ™¯åŒ–è§£æ±ºæ–¹æ¡ˆ/_annex/Pasted image 20211209174854.png]]

	![[Study_Matthew/åˆ†å¸ƒå¼é›†ç¾¤æ¶æ§‹å ´æ™¯åŒ–è§£æ±ºæ–¹æ¡ˆ/_annex/Pasted image 20211209174911.png]]

	åŸç†ç¤ºæ„ï¼ˆäº†è§£ï¼‰

	![[Study_Matthew/åˆ†å¸ƒå¼é›†ç¾¤æ¶æ§‹å ´æ™¯åŒ–è§£æ±ºæ–¹æ¡ˆ/_annex/Pasted image 20211209174942.png]]


	