---
界: NoSQL
門: Redis
綱: 
tags: ["#NoSQL","#Redis","#Cache","#BQ"]
aliases:
  - 
date: 2021-09-07

---


## 快取雪崩
*大量key失效，透過快取，直接訪問db*

-  key的失效期增加隨機時長，如200s，100s，錯開每個快取key的快取時間
-   redis-cluster集群高可用
-   設定本地快取ehcache、hystrix熔斷限流

## 快取穿透
*不存在的key，穿過快取查詢數據庫*

-   對查詢結果為空的情況也進行快取，快取時間（ttl）設定短一點，或者該key對應的數據insert了 之後清理快取。
    
    問題：快取太多空值佔用了更多的空間
    
-   使用布隆過濾器。在快取之前在加一層布隆過濾器，在查詢的時候先去布隆過濾器查詢 key 是否 存在，如果不存在就直接返回，存在再查快取和DB。
    
    布隆過濾器的原理是，當一個元素被加入集合時，通過K個Hash函式將這個元素對映成一個陣列中的K個點，把它們置為1。檢索時，我們只要看看這些點是不是都是1就（大約）知道集合中有沒有它了：如果這些點有任何一個0，則被檢元素一定不在；如果都是1，則被檢元素很可能在。
    

## 快取擊穿
*一個key或一些key 熱點key*

-   用分佈式鎖控制訪問的執行緒
-   不設超時時間，volatile-lru 但會造成寫一致問題